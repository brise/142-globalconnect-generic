<div class="v3">

    <block-menu class="tabs">
        <a ng-click="$data.editor.scope[0] = 0;" ng-class="{selected: ($data.editor.scope[0] == 0), darker: ($data.editor.scope[0] == 0)}">{{ :: $dict.label_elements }}</a>
        <a ng-click="$data.editor.scope[0] = 1;" ng-class="{selected: ($data.editor.scope[0] == 1)}">{{ :: $dict.label_settings }}</a>
        <a ng-click="$data.editor.scope[0] = 2;" ng-class="{selected: ($data.editor.scope[0] == 2)}">{{ :: $dict.label_variables }}</a>
    </block-menu>

    <!-- ELEMENTS -->
    <block ng-if="$data.editor.scope[0] == 0">

        
<!-- SEQUENCED ELEMENTS -->
<block-group>

    <block-field title="{{ :: $dict.label_sequenced_elements }}" class="label"></block-field>

    <frames-block ng-model="$data.banner.layers.CV.layers.SQ"
                  default-settings="$data.banner.layers.CV.layers.SQ.params"
                  default-frame-data="$data.banner.layers.CV.layers.SQ.frames[0]">

        <!-- FRAME INDEX VALIDATION -->
        <data ng-init="$frame_selected = false"></data>
        <data ng-if="$frame_selected === false" ng-init="$frame_selected = true; $frames.go($data.editor.frame);"></data>
        <data ng-if="$data.editor.frame !== $frames.index" ng-init="$data.editor.frame = $frames.index"></data>
        <!-- / FRAME INDEX VALIDATION -->

        <frames-block-controls class="no-start-time no-stop-time no-stop-on no-duration"></frames-block-controls>

        <block-toggle title="{{ :: $dict.label_frame }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('SQ') != -1)}"
                      ng-click="$data.editor.scope[1] = (($data.editor.scope[1] == 'SQ') ? '' : 'SQ')"></block-toggle>
        <block-group ng-if="($data.editor.scope[1].indexOf('SQ') == -1)">

            <!-- KEY DEFINITION -->
            <data ng-if="$wrapper_key = 'SQ'"></data>
            <data ng-if="$alias_key = $wrapper_key"></data>
            <!-- / KEY DEFINITION -->

            <!-- TAB SETUP -->
            <data ng-init="$tab_setup = [['setup'], 'setup', ['setup'], 'setup']"></data>
            <!-- / TAB SETUP -->

            <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

            <!-- SHORTCUT DEFINITION -->
            <data ng-if="$wrapper = $frame"></data>
            <data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
            <!-- / SHORTCUT DEFINITION -->

            <!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


            <data ng-if="$scope[1] = 'setup'"></data>

            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- FRAME SETTINGS -->
<!--<block-group>-->

<frames-block-controls class="no-start-time no-stop-time no-stop-on no-frames"></frames-block-controls>

<block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_type }}">
    <dropdown-select model="$macros[$wrapper_key + '_type'].value">
        <optgroup label="{{ :: $dict.label_regular }} {{ :: $dict.label_frames }}">
    <option value="split">{{ :: $dict.label_message }}</option>
</optgroup>
<!--<optgroup label="{{ :: $dict.label_special }} {{ :: $dict.label_frames }}">
    <option value="button">{{ :: $dict.label_button }} ({{ :: $dict.label_if_applicable }})</option>
</optgroup>-->
<optgroup label="{{ :: $dict.label_modal }} {{ :: $dict.label_frames }}">
    <option value="disclaimer">{{ :: $dict.label_disclaimer }}</option>
</optgroup>
    </dropdown-select>
</block-field>

<!--<block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_filter }}">
    <dropdown-select model="$macros[$wrapper_key + '_filter'].value">
        <option value="none">{{ :: $dict.label_disabled }}</option>
<optgroup label="{{ :: $dict.label_split }} {{ :: $dict.label_filters }}">
    <option value="split_all">{{ :: $dict.label_filter_split_all }}</option>
    <option value="split_limited">{{ :: $dict.label_filter_split_limited }}</option>
    <option value="split_micro">{{ :: $dict.label_filter_split_micro }}</option>
    <option value="split_small">{{ :: $dict.label_filter_split_small_micro }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_exclusion }} {{ :: $dict.label_filters }}">
    <option value="limited_exc">{{ :: $dict.label_filter_exclude_limited }}</option>
    <option value="micro_exc">{{ :: $dict.label_filter_exclude_micro }}</option>
    <option value="small_exc">{{ :: $dict.label_filter_exclude_small_micro }}</option>
    <option value="large_exc">{{ :: $dict.label_filter_exclude_large_huge }}</option>
    <option value="snapshot_exc">{{ :: $dict.label_filter_exclude_snapshot }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_inclusion }} {{ :: $dict.label_filters }}">
    <option value="limited">{{ :: $dict.label_filter_include_limited }}</option>
    <option value="micro">{{ :: $dict.label_filter_include_micro }}</option>
    <option value="small">{{ :: $dict.label_filter_include_small_micro }}</option>
    <option value="large">{{ :: $dict.label_filter_include_large_huge }}</option>
    <option value="snapshot">{{ :: $dict.label_filter_include_snapshot }}</option>
</optgroup>
    </dropdown-select>
</block-field>-->

<!--</block-group>-->
<!-- / FRAME SETTINGS -->

        </block-group>
        <block-group ng-if="($data.editor.scope[1].indexOf('SQ') != -1)">

            <!-- KEY DEFINITION -->
            <data ng-if="$wrapper_key = 'SQ'"></data>
            <data ng-if="$data.editor.element = $wrapper_key"></data>
            <data ng-if="$alias_key = $wrapper_key"></data>
            <!-- / KEY DEFINITION -->

            <!-- TAB SETUP -->
            <data ng-init="$tab_setup = [['setup', 'appear'], 'setup', ['appear'], 'appear']"></data>
            <!-- / TAB SETUP -->

            <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

            <!-- SHORTCUT DEFINITION -->
            <data ng-if="$wrapper = $frame"></data>
            <data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
            <!-- / SHORTCUT DEFINITION -->

            <!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


            <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

            <div ng-if="($scope[1] == 'setup')">
                
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- FRAME SETTINGS -->
<block-group>

    <frames-block-controls class="no-start-time no-stop-time no-stop-on no-frames"></frames-block-controls>

    <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_type }}">
        <dropdown-select model="$macros[$wrapper_key + '_type'].value">
            <optgroup label="{{ :: $dict.label_regular }} {{ :: $dict.label_frames }}">
    <option value="split">{{ :: $dict.label_message }}</option>
</optgroup>
<!--<optgroup label="{{ :: $dict.label_special }} {{ :: $dict.label_frames }}">
    <option value="button">{{ :: $dict.label_button }} ({{ :: $dict.label_if_applicable }})</option>
</optgroup>-->
<optgroup label="{{ :: $dict.label_modal }} {{ :: $dict.label_frames }}">
    <option value="disclaimer">{{ :: $dict.label_disclaimer }}</option>
</optgroup>
        </dropdown-select>
    </block-field>

    <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_filter }}">
        <dropdown-select model="$macros[$wrapper_key + '_filter'].value">
            <option value="none">{{ :: $dict.label_disabled }}</option>
<optgroup label="{{ :: $dict.label_split }} {{ :: $dict.label_filters }}">
    <option value="split_all">{{ :: $dict.label_filter_split_all }}</option>
    <option value="split_limited">{{ :: $dict.label_filter_split_limited }}</option>
    <option value="split_micro">{{ :: $dict.label_filter_split_micro }}</option>
    <option value="split_small">{{ :: $dict.label_filter_split_small_micro }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_exclusion }} {{ :: $dict.label_filters }}">
    <option value="limited_exc">{{ :: $dict.label_filter_exclude_limited }}</option>
    <option value="micro_exc">{{ :: $dict.label_filter_exclude_micro }}</option>
    <option value="small_exc">{{ :: $dict.label_filter_exclude_small_micro }}</option>
    <option value="large_exc">{{ :: $dict.label_filter_exclude_large_huge }}</option>
    <option value="snapshot_exc">{{ :: $dict.label_filter_exclude_snapshot }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_inclusion }} {{ :: $dict.label_filters }}">
    <option value="limited">{{ :: $dict.label_filter_include_limited }}</option>
    <option value="micro">{{ :: $dict.label_filter_include_micro }}</option>
    <option value="small">{{ :: $dict.label_filter_include_small_micro }}</option>
    <option value="large">{{ :: $dict.label_filter_include_large_huge }}</option>
    <option value="snapshot">{{ :: $dict.label_filter_include_snapshot }}</option>
</optgroup>
        </dropdown-select>
    </block-field>

    <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_priority }}">
        <dropdown-select model="$macros[$wrapper_key + '_priority'].value">
            <option value="high">High</option>
            <option value="medium">Medium</option>
            <option value="low">Low</option>
        </dropdown-select>
    </block-field>

</block-group>
<!-- / FRAME SETTINGS -->

<!-- / FRAME DESTINATION -->
<block-group ng-if="$data.banner.clicktag.override">

    <block-field title="{{ :: $dict.label_destination }} URL" ng-class="{disabled: ($data.banner.macros['feed_0'].value && $wrapper.groups['SQ_feed'].macros['SQ_feed_' + 'CL'].value)}">
        <text-field placeholder="{{ $data.banner.clicktag.url }}" model="$wrapper.clicktag.url"
                    pattern="https?\:\/\/.+|\$\[dest_url\]|\$\{dest_url\}"></text-field>
        <block-info ng-if="(_.size($variation_setup[0]) <= 1 && $data.editor.scope[1].indexOf('SQ') != -1)">
            <p>
                <small><q>
                    You may change global click tag value at global settings <a ng-click="$data.editor.scope[0] = 2; $data.editor.scope[2] = 'destination';">destination</a> settings.
                </q></small>
            </p>
        </block-info>
        <block-info ng-if="$data.banner.macros['feed_0'].value && $wrapper.groups['SQ_feed'].macros['SQ_feed_' + 'CL'].value">
            <p>
                <small><q>{{ :: $dict.hint_feed_active }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / FRAME DESTINATION -->
            </div>

            <div ng-if="($scope[1] == 'appear')">
                
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled">

    <!-- FRAME LAYOUT -->
    <!--<block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_arrangement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_layout }}">
            <dropdown-select model="$macros[$alias_key + '_layout'].value">
                <option value="default">{{ :: $dict.label_default }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_frame  }} {{ :: $dict.label_arrangement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_layout }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_layout'].value">
                <option value="default">{{ :: $dict.label_default }}</option>
            </dropdown-select>
        </block-field>

    </block-group>-->
    <!-- / FRAME LAYOUT -->

    <!-- DEFAULT THEME -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_preset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_theme }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'CV_theme'].value">
                <option value="$[CV_theme]">{{ :: $dict.label_default }}</option>
                <option disabled>-</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
<option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_frame }} {{ :: $dict.label_preset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_theme }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'CV_theme'].value">
                <option value="$[CV_theme]">{{ :: $dict.label_default }}</option>
                <option disabled>-</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
<option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / DEFAULT THEME -->

    <!-- LG COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_logotype }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'LG_lg'].value">
                <option value="$[LG_lg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'LG_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_logotype }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'LG_lg'].value">
                <option value="$[LG_lg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'LG_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / LG COLORS -->

    <!-- MS COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_message }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'MS_st'].value">
                <option value="$[MS_st]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'MS_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_message }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'MS_st'].value">
                <option value="$[MS_st]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'MS_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MS COLORS -->

    <!-- BS COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_button }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'BS_bt'].value">
                <option value="$[BS_bt]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_shadow }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'BS_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_button }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'BS_bt'].value">
                <option value="$[BS_bt]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_shadow }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'BS_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

    </block-group>
    <!-- / BS COLORS -->

    <!-- FRAME COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_supporting }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'UL_bg'].value">
                <option value="$[UL_bg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'IL_bg'].value">
                <option value="$[IL_bg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'OL_gr'].value">
                <option value="$[OL_gr]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_shadow }}">
            <dropdown-select model="$macros[$alias_key + '_' + 'CV_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_supporting }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'UL_bg'].value">
                <option value="$[UL_bg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'IL_bg'].value">
                <option value="$[IL_bg]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'OL_gr'].value">
                <option value="$[OL_gr]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_shadow }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_' + 'CV_sh'].value">
                <option value="$[CV_sh]">{{ :: $dict.label_default }}</option>
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

    </block-group>
    <!-- / FRAME COLORS -->

</div>
            </div>

        </block-group>

        <block-toggle title="{{ :: $dict.label_foreground }}" class="toggle"
                      ng-class="{selected: ($data.editor.scope[1].indexOf('FG') != -1 && ($frame.groups.SQ_setup.macros.SQ_type.value != 'blank' && $frame.groups.SQ_setup.macros.SQ_type.value != 'text' && $frame.groups.SQ_setup.macros.SQ_type.value != 'dealer' && $frame.groups.SQ_setup.macros.SQ_type.value != 'disclaimer')), disabled: ($frame.groups.SQ_setup.macros.SQ_type.value == 'blank' || $frame.groups.SQ_setup.macros.SQ_type.value == 'text' || $frame.groups.SQ_setup.macros.SQ_type.value == 'dealer' || $frame.groups.SQ_setup.macros.SQ_type.value == 'disclaimer')}"
                      ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('FG') != -1) ? '' : 'FG')"></block-toggle>
        <block-group ng-if="($data.editor.scope[1].indexOf('FG') != -1) && ($frame.groups.SQ_setup.macros.SQ_type.value != 'blank' && $frame.groups.SQ_setup.macros.SQ_type.value != 'text' && $frame.groups.SQ_setup.macros.SQ_type.value != 'dealer' && $frame.groups.SQ_setup.macros.SQ_type.value != 'disclaimer')">

            
<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'FG'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['elements', 'anim', 'layout', 'appear'], 'elements', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<block-group ng-if="($scope[1] == 'elements')">

    <block-toggle title="{{ :: $dict.label_image }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('FG_FI') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('FG_FI') != -1) ? 'FG' : 'FG_FI')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('FG_FI') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'IMG'"></data>
        <data ng-if="$target_key = '0'"></data>
        <data ng-if="$alias_key = 'FI'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'quality', 'anim', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $holder_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$holder_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$holder_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$holder_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[2]"></data>
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][1] = $tab_setup[3]"></data>
<data ng-if="$holder.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->

        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper_group_appear = $wrapper.groups[$wrapper_key + '_' + 'appear']"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$target_excepts = $target.excepts"></data>
<data ng-if="$target_excepts_preset = $target.excepts.preset"></data>
<data ng-if="$target_preset = $holder.presets[$target_key]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $target_excepts && $target_excepts_preset && $target_excepts[$variation_scope[1]] == undefined" ng-init="$target_excepts[$variation_scope[1]] = _.cloneDeep($target_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->
        <data ng-repeat="$key in $variations['EL_orient']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true : $macros_excepts[$key].enabled"></data>
        <data ng-repeat="$key in $variations['CV_tens']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true :$macros_excepts[$key].enabled"></data>
        <!-- / PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($target_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="CV_size_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace($key, 'CV_size_', '') }} {{ ($target_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$target_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$target_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $target_excepts) in $target_excepts">
													<q ng-if="$target_excepts.enabled && $target_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace($key, 'CV_size_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $target_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- IMAGE SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <image-picker model="$holder.layers[0]"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <block-info>
            <p>
                <small ng-if="$holder.layers[0] != null"><q><a ng-click="$holder.layers[0] = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }}</q></small>
                <small ng-if="$frames && $data.editor.frame >= 1"><q><a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$target_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">

        <image-picker model="$target_excepts['EL_orient_p'].data" ng-if="$variation_scope[1] == 'EL_orient_p'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['EL_orient_s'].data" ng-if="$variation_scope[1] == 'EL_orient_s'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['EL_orient_l'].data" ng-if="$variation_scope[1] == 'EL_orient_l'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_scale_xs'].data" ng-if="$variation_scope[1] == 'CV_scale_xs'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_s'].data" ng-if="$variation_scope[1] == 'CV_scale_s'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_m'].data" ng-if="$variation_scope[1] == 'CV_scale_m'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_l'].data" ng-if="$variation_scope[1] == 'CV_scale_l'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_xl'].data" ng-if="$variation_scope[1] == 'CV_scale_xl'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_tens_t3'].data" ng-if="$variation_scope[1] == 'CV_tens_t3'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t2'].data" ng-if="$variation_scope[1] == 'CV_tens_t2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t1'].data" ng-if="$variation_scope[1] == 'CV_tens_t1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_e0'].data" ng-if="$variation_scope[1] == 'CV_tens_e0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t0'].data" ng-if="$variation_scope[1] == 'CV_tens_t0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w0'].data" ng-if="$variation_scope[1] == 'CV_tens_w0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w1'].data" ng-if="$variation_scope[1] == 'CV_tens_w1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w2'].data" ng-if="$variation_scope[1] == 'CV_tens_w2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w3'].data" ng-if="$variation_scope[1] == 'CV_tens_w3'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['snapshot'].data" ng-if="$variation_scope[1] == 'snapshot'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_size_120x600'].data" ng-if="$variation_scope[1] == 'CV_size_120x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_140x350'].data" ng-if="$variation_scope[1] == 'CV_size_140x350'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_150x600'].data" ng-if="$variation_scope[1] == 'CV_size_150x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_160x80'].data" ng-if="$variation_scope[1] == 'CV_size_160x80'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_160x600'].data" ng-if="$variation_scope[1] == 'CV_size_160x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_180x500'].data" ng-if="$variation_scope[1] == 'CV_size_180x500'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x200'].data" ng-if="$variation_scope[1] == 'CV_size_200x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x350'].data" ng-if="$variation_scope[1] == 'CV_size_200x350'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x600'].data" ng-if="$variation_scope[1] == 'CV_size_200x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x700'].data" ng-if="$variation_scope[1] == 'CV_size_200x700'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_240x400'].data" ng-if="$variation_scope[1] == 'CV_size_240x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x250'].data" ng-if="$variation_scope[1] == 'CV_size_250x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x360'].data" ng-if="$variation_scope[1] == 'CV_size_250x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x600'].data" ng-if="$variation_scope[1] == 'CV_size_250x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x800'].data" ng-if="$variation_scope[1] == 'CV_size_250x800'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x50'].data" ng-if="$variation_scope[1] == 'CV_size_300x50'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x100'].data" ng-if="$variation_scope[1] == 'CV_size_300x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x200'].data" ng-if="$variation_scope[1] == 'CV_size_300x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x250'].data" ng-if="$variation_scope[1] == 'CV_size_300x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x300'].data" ng-if="$variation_scope[1] == 'CV_size_300x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x600'].data" ng-if="$variation_scope[1] == 'CV_size_300x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x1050'].data" ng-if="$variation_scope[1] == 'CV_size_300x1050'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x50'].data" ng-if="$variation_scope[1] == 'CV_size_320x50'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x100'].data" ng-if="$variation_scope[1] == 'CV_size_320x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x160'].data" ng-if="$variation_scope[1] == 'CV_size_320x160'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x240'].data" ng-if="$variation_scope[1] == 'CV_size_320x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x250'].data" ng-if="$variation_scope[1] == 'CV_size_320x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x280'].data" ng-if="$variation_scope[1] == 'CV_size_320x280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x320'].data" ng-if="$variation_scope[1] == 'CV_size_320x320'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x400'].data" ng-if="$variation_scope[1] == 'CV_size_320x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x480'].data" ng-if="$variation_scope[1] == 'CV_size_320x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_336x280'].data" ng-if="$variation_scope[1] == 'CV_size_336x280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_350x250'].data" ng-if="$variation_scope[1] == 'CV_size_350x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_400x600'].data" ng-if="$variation_scope[1] == 'CV_size_400x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x60'].data" ng-if="$variation_scope[1] == 'CV_size_468x60'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x360'].data" ng-if="$variation_scope[1] == 'CV_size_468x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x480'].data" ng-if="$variation_scope[1] == 'CV_size_468x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x120'].data" ng-if="$variation_scope[1] == 'CV_size_480x120'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x300'].data" ng-if="$variation_scope[1] == 'CV_size_480x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x480'].data" ng-if="$variation_scope[1] == 'CV_size_480x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_540x960'].data" ng-if="$variation_scope[1] == 'CV_size_540x960'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_580x400'].data" ng-if="$variation_scope[1] == 'CV_size_580x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_600x400'].data" ng-if="$variation_scope[1] == 'CV_size_600x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x320'].data" ng-if="$variation_scope[1] == 'CV_size_640x320'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x360'].data" ng-if="$variation_scope[1] == 'CV_size_640x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x640'].data" ng-if="$variation_scope[1] == 'CV_size_640x640'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x1000'].data" ng-if="$variation_scope[1] == 'CV_size_640x1000'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_660x100'].data" ng-if="$variation_scope[1] == 'CV_size_660x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_712x250'].data" ng-if="$variation_scope[1] == 'CV_size_712x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_720x1280'].data" ng-if="$variation_scope[1] == 'CV_size_720x1280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_720x1560'].data" ng-if="$variation_scope[1] == 'CV_size_720x1560'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_728x90'].data" ng-if="$variation_scope[1] == 'CV_size_728x90'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x100'].data" ng-if="$variation_scope[1] == 'CV_size_750x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key like '+_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x200'].data" ng-if="$variation_scope[1] == 'CV_size_750x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x300'].data" ng-if="$variation_scope[1] == 'CV_size_750x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_768x240'].data" ng-if="$variation_scope[1] == 'CV_size_768x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_800x250'].data" ng-if="$variation_scope[1] == 'CV_size_800x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_825x100'].data" ng-if="$variation_scope[1] == 'CV_size_825x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_852x640'].data" ng-if="$variation_scope[1] == 'CV_size_852x640'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_910x250'].data" ng-if="$variation_scope[1] == 'CV_size_910x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_930x180'].data" ng-if="$variation_scope[1] == 'CV_size_930x180'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_960x540'].data" ng-if="$variation_scope[1] == 'CV_size_960x540'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_960x1200'].data" ng-if="$variation_scope[1] == 'CV_size_960x1200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x90'].data" ng-if="$variation_scope[1] == 'CV_size_970x90'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x210'].data" ng-if="$variation_scope[1] == 'CV_size_970x210'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x250'].data" ng-if="$variation_scope[1] == 'CV_size_970x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x300'].data" ng-if="$variation_scope[1] == 'CV_size_970x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x310'].data" ng-if="$variation_scope[1] == 'CV_size_970x310'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x120'].data" ng-if="$variation_scope[1] == 'CV_size_980x120'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x240'].data" ng-if="$variation_scope[1] == 'CV_size_980x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x250'].data" ng-if="$variation_scope[1] == 'CV_size_980x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x300'].data" ng-if="$variation_scope[1] == 'CV_size_980x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x600'].data" ng-if="$variation_scope[1] == 'CV_size_980x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1000x100'].data" ng-if="$variation_scope[1] == 'CV_size_1000x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1020x200'].data" ng-if="$variation_scope[1] == 'CV_size_1020x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1024x81'].data" ng-if="$variation_scope[1] == 'CV_size_1024x81'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1080'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1080'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1920'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1168x250'].data" ng-if="$variation_scope[1] == 'CV_size_1168x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x200'].data" ng-if="$variation_scope[1] == 'CV_size_1200x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x250'].data" ng-if="$variation_scope[1] == 'CV_size_1200x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x628'].data" ng-if="$variation_scope[1] == 'CV_size_1200x628'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x1200'].data" ng-if="$variation_scope[1] == 'CV_size_1200x1200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + thewrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1250x240'].data" ng-if="$variation_scope[1] == 'CV_size_1250x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1250x360'].data" ng-if="$variation_scope[1] == 'CV_size_1250x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1400x940'].data" ng-if="$variation_scope[1] == 'CV_size_1400x940'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1920x900'].data" ng-if="$variation_scope[1] == 'CV_size_1920x900'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1920x1080'].data" ng-if="$variation_scope[1] == 'CV_size_1920x1080'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_size_1080x1920_meta_reel'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920_meta_reel'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1920_meta_story'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920_meta_story'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <block-info ng-class="{disabled: ($target_excepts[$variation_scope[1]].data)}">
            <p>
                <small ng-if="$target_excepts[$variation_scope[1]].data.sources != null"><q><a ng-click="$target_excepts[$variation_scope[1]].data = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }} </q></small>
                <small><q><a ng-click="$target_excepts[$variation_scope[1]].data = _.omit(_.cloneDeep($target), ['excepts', 'preset'])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / IMAGE SOURCE PICKER -->

<!-- IMAGE CROP PICKER -->
<block-group ng-if="$target && $variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_crop }}">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default' && $target_excepts[$variation_scope[1]].data.sources" ng-class="{disabled: (!$target_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_crop }} *">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<!-- / IMAGE CROP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'quality')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_image_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- IMAGE FORMAT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_format }}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_format }}" ng-class="{disabled: ($variation_scope[1] != 'default')}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE FORMAT PICKER -->

    <!-- IMAGE QUALITY PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE QUALITY PICKER -->

    <!-- IMAGE SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE SCALE PICKER -->

</div>
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$holder.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$holder.enabled">

    <!-- IMAGE EFFECTS PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_trim }}">
            <dropdown-select model="$macros[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_spread }}" ng-class="{disabled: ($macros[$alias_key + '_resize_method'].value == 'none' || $macros[$alias_key + '_resize_method'].value == 'select')}">
            <number-slider model="$macros[$alias_key + '_resize_extend'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_extend }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_sharpen }}">
            <number-slider model="$macros[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }}">
            <number-slider model="$macros[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_trim }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_spread }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value == 'none' || $macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value == 'select')}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_extend'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_extend }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_sharpen }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / IMAGE EFFECTS PICKER -->

</div>
        </div>

    </block-group>

</block-group>

<div ng-if="($scope[1] == 'anim')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SETUP PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}" ng-if="$group">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_animation_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / ANIMATION SETUP PICKER -->

<div ng-if="$group.enabled">

    <!-- ANIMATION SPEED IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }}">
            <number-slider model="$macros[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED IN -->

    <!-- ANIMATIONS TRANSITION IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION IN -->

    <!-- ANIMATION SPEED OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED OUT -->

    <!-- ANIMATIONS TRANSITION OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION OUT -->

</div>
</div>

<div ng-if="($scope[1] == 'layout')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_layout_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- ALIGNMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }}" ng-if="$macros[$alias_key + '_justify']">
            <dropdown-select model="$macros[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <dropdown-select model="$macros[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <dropdown-select model="$macros[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }} *" ng-if="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ALIGNMENT PICKER -->

    <!-- OFFSET PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}" ng-if="$variation_scope[1] == 'default'" >
            <number-slider model="$macros[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / OFFSET PICKER -->

    <!-- SIZE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }}">
            <number-slider model="$macros[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }}">
            <number-slider model="$macros[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }}">
            <number-slider model="$macros[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }}">
            <number-slider model="$macros[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }}">
            <number-slider model="$macros[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / SIZE PICKER -->

</div>
</div>

<div ng-if="($scope[1] == 'appear')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_place']">

    <!-- PLACEMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }}">
            <dropdown-select model="$macros[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / PLACEMENT PICKER -->

</div>

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_mask']">

    <!-- MASK PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }}">
            <dropdown-select model="$macros[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }}" ng-class="{disabled: ($macros[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MASK PICKER -->

</div>

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_theme'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

        </block-group>

        <block-toggle title="{{ :: $dict.label_message }}" class="toggle"
                      ng-class="{selected: ($data.editor.scope[1].indexOf('MS') != -1 && $frame.groups.SQ_setup.macros.SQ_type.value == 'split'), disabled: ($frame.groups.SQ_setup.macros.SQ_type.value != 'split')}"
                      ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('MS') != -1) ? '' : 'MS')"></block-toggle>
        <block-group ng-if="($data.editor.scope[1].indexOf('MS') != -1 && $frame.groups.SQ_setup.macros.SQ_type.value == 'split')">

            
<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'MS'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['elements', 'anim', 'layout', 'appear'], 'elements', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<block-group ng-if="($scope[1] == 'elements')">

    <block-toggle title="{{ :: $dict.label_call }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('MS_MA') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('MS_MA') != -1) ? 'MS' : 'MS_MA')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('MS_MA') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'TXT'"></data>
        <data ng-if="$target_key = '0'"></data>
        <data ng-if="$alias_key = 'MA'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'anim', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
        </div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_title }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('MS_MB') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('MS_MB') != -1) ? 'MS' : 'MS_MB')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('MS_MB') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'TXT'"></data>
        <data ng-if="$target_key = '1'"></data>
        <data ng-if="$alias_key = 'MB'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'anim', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
        </div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_subtitle }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('MS_MC') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('MS_MC') != -1) ? 'MS' : 'MS_MC')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('MS_MC') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'TXT'"></data>
        <data ng-if="$target_key = '2'"></data>
        <data ng-if="$alias_key = 'MC'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'anim', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
        </div>

    </block-group>

</block-group>

<div ng-if="($scope[1] == 'anim')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SETUP PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}" ng-if="$group">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_animation_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / ANIMATION SETUP PICKER -->

<div ng-if="$group.enabled">

    <!-- ANIMATION SPEED IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }}">
            <number-slider model="$macros[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED IN -->

    <!-- ANIMATIONS TRANSITION IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION IN -->

    <!-- ANIMATION SPEED OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED OUT -->

    <!-- ANIMATIONS TRANSITION OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION OUT -->

</div>
</div>

<div ng-if="($scope[1] == 'layout')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_layout_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- ALIGNMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }}" ng-if="$macros[$alias_key + '_justify']">
            <dropdown-select model="$macros[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <dropdown-select model="$macros[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <dropdown-select model="$macros[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }} *" ng-if="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ALIGNMENT PICKER -->

    <!-- OFFSET PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}" ng-if="$variation_scope[1] == 'default'" >
            <number-slider model="$macros[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / OFFSET PICKER -->

    <!-- SIZE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }}">
            <number-slider model="$macros[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }}">
            <number-slider model="$macros[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }}">
            <number-slider model="$macros[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }}">
            <number-slider model="$macros[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }}">
            <number-slider model="$macros[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / SIZE PICKER -->

</div>
</div>

<div ng-if="($scope[1] == 'appear')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_place']">

    <!-- PLACEMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }}">
            <dropdown-select model="$macros[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / PLACEMENT PICKER -->

</div>

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_mask']">

    <!-- MASK PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }}">
            <dropdown-select model="$macros[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }}" ng-class="{disabled: ($macros[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MASK PICKER -->

</div>

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_theme'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

        </block-group>

    </frames-block>

</block-group>
<!-- / SEQUENCED ELEMENTS -->

<!-- COMMON ELEMENTS -->
<block-group>

    <block-field title="{{ :: $dict.label_common_elements }}" class="label"></block-field>

    <block-toggle title="{{ :: $dict.label_background }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('BG') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('BG') != -1) ? '' : 'BG')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('BG') != -1)">

        <data ng-if="$frame = $data.banner.layers.CV"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'BG'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['elements', 'anim', 'layout', 'appear'], 'elements', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<block-group ng-if="($scope[1] == 'elements')">

    <block-toggle title="{{ :: $dict.label_image }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('BG_BI') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('BG_BI') != -1) ? 'BG' : 'BG_BI')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('BG_BI') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'IMG'"></data>
        <data ng-if="$target_key = '0'"></data>
        <data ng-if="$alias_key = 'BI'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'quality', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $holder_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$holder_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$holder_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$holder_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[2]"></data>
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][1] = $tab_setup[3]"></data>
<data ng-if="$holder.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->

        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper_group_appear = $wrapper.groups[$wrapper_key + '_' + 'appear']"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$target_excepts = $target.excepts"></data>
<data ng-if="$target_excepts_preset = $target.excepts.preset"></data>
<data ng-if="$target_preset = $holder.presets[$target_key]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $target_excepts && $target_excepts_preset && $target_excepts[$variation_scope[1]] == undefined" ng-init="$target_excepts[$variation_scope[1]] = _.cloneDeep($target_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->
        <data ng-repeat="$key in $variations['EL_orient']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true : $macros_excepts[$key].enabled"></data>
        <data ng-repeat="$key in $variations['CV_tens']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true :$macros_excepts[$key].enabled"></data>
        <!-- / PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($target_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="CV_size_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace($key, 'CV_size_', '') }} {{ ($target_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$target_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$target_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $target_excepts) in $target_excepts">
													<q ng-if="$target_excepts.enabled && $target_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace($key, 'CV_size_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $target_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- IMAGE SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <image-picker model="$holder.layers[0]"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <block-info>
            <p>
                <small ng-if="$holder.layers[0] != null"><q><a ng-click="$holder.layers[0] = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }}</q></small>
                <small ng-if="$frames && $data.editor.frame >= 1"><q><a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$target_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">

        <image-picker model="$target_excepts['EL_orient_p'].data" ng-if="$variation_scope[1] == 'EL_orient_p'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['EL_orient_s'].data" ng-if="$variation_scope[1] == 'EL_orient_s'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['EL_orient_l'].data" ng-if="$variation_scope[1] == 'EL_orient_l'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_scale_xs'].data" ng-if="$variation_scope[1] == 'CV_scale_xs'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_s'].data" ng-if="$variation_scope[1] == 'CV_scale_s'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_m'].data" ng-if="$variation_scope[1] == 'CV_scale_m'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_l'].data" ng-if="$variation_scope[1] == 'CV_scale_l'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_scale_xl'].data" ng-if="$variation_scope[1] == 'CV_scale_xl'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_tens_t3'].data" ng-if="$variation_scope[1] == 'CV_tens_t3'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t2'].data" ng-if="$variation_scope[1] == 'CV_tens_t2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t1'].data" ng-if="$variation_scope[1] == 'CV_tens_t1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_e0'].data" ng-if="$variation_scope[1] == 'CV_tens_e0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_t0'].data" ng-if="$variation_scope[1] == 'CV_tens_t0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w0'].data" ng-if="$variation_scope[1] == 'CV_tens_w0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w1'].data" ng-if="$variation_scope[1] == 'CV_tens_w1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w2'].data" ng-if="$variation_scope[1] == 'CV_tens_w2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_tens_w3'].data" ng-if="$variation_scope[1] == 'CV_tens_w3'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['snapshot'].data" ng-if="$variation_scope[1] == 'snapshot'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_size_120x600'].data" ng-if="$variation_scope[1] == 'CV_size_120x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_140x350'].data" ng-if="$variation_scope[1] == 'CV_size_140x350'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_150x600'].data" ng-if="$variation_scope[1] == 'CV_size_150x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_160x80'].data" ng-if="$variation_scope[1] == 'CV_size_160x80'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_160x600'].data" ng-if="$variation_scope[1] == 'CV_size_160x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_180x500'].data" ng-if="$variation_scope[1] == 'CV_size_180x500'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x200'].data" ng-if="$variation_scope[1] == 'CV_size_200x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x350'].data" ng-if="$variation_scope[1] == 'CV_size_200x350'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x600'].data" ng-if="$variation_scope[1] == 'CV_size_200x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_200x700'].data" ng-if="$variation_scope[1] == 'CV_size_200x700'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_240x400'].data" ng-if="$variation_scope[1] == 'CV_size_240x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x250'].data" ng-if="$variation_scope[1] == 'CV_size_250x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x360'].data" ng-if="$variation_scope[1] == 'CV_size_250x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x600'].data" ng-if="$variation_scope[1] == 'CV_size_250x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_250x800'].data" ng-if="$variation_scope[1] == 'CV_size_250x800'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x50'].data" ng-if="$variation_scope[1] == 'CV_size_300x50'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x100'].data" ng-if="$variation_scope[1] == 'CV_size_300x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x200'].data" ng-if="$variation_scope[1] == 'CV_size_300x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x250'].data" ng-if="$variation_scope[1] == 'CV_size_300x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x300'].data" ng-if="$variation_scope[1] == 'CV_size_300x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x600'].data" ng-if="$variation_scope[1] == 'CV_size_300x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_300x1050'].data" ng-if="$variation_scope[1] == 'CV_size_300x1050'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x50'].data" ng-if="$variation_scope[1] == 'CV_size_320x50'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x100'].data" ng-if="$variation_scope[1] == 'CV_size_320x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x160'].data" ng-if="$variation_scope[1] == 'CV_size_320x160'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x240'].data" ng-if="$variation_scope[1] == 'CV_size_320x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x250'].data" ng-if="$variation_scope[1] == 'CV_size_320x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x280'].data" ng-if="$variation_scope[1] == 'CV_size_320x280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x320'].data" ng-if="$variation_scope[1] == 'CV_size_320x320'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x400'].data" ng-if="$variation_scope[1] == 'CV_size_320x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_320x480'].data" ng-if="$variation_scope[1] == 'CV_size_320x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_336x280'].data" ng-if="$variation_scope[1] == 'CV_size_336x280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_350x250'].data" ng-if="$variation_scope[1] == 'CV_size_350x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_400x600'].data" ng-if="$variation_scope[1] == 'CV_size_400x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x60'].data" ng-if="$variation_scope[1] == 'CV_size_468x60'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x360'].data" ng-if="$variation_scope[1] == 'CV_size_468x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_468x480'].data" ng-if="$variation_scope[1] == 'CV_size_468x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x120'].data" ng-if="$variation_scope[1] == 'CV_size_480x120'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x300'].data" ng-if="$variation_scope[1] == 'CV_size_480x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_480x480'].data" ng-if="$variation_scope[1] == 'CV_size_480x480'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_540x960'].data" ng-if="$variation_scope[1] == 'CV_size_540x960'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_580x400'].data" ng-if="$variation_scope[1] == 'CV_size_580x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_600x400'].data" ng-if="$variation_scope[1] == 'CV_size_600x400'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x320'].data" ng-if="$variation_scope[1] == 'CV_size_640x320'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x360'].data" ng-if="$variation_scope[1] == 'CV_size_640x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x640'].data" ng-if="$variation_scope[1] == 'CV_size_640x640'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_640x1000'].data" ng-if="$variation_scope[1] == 'CV_size_640x1000'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_660x100'].data" ng-if="$variation_scope[1] == 'CV_size_660x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_712x250'].data" ng-if="$variation_scope[1] == 'CV_size_712x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_720x1280'].data" ng-if="$variation_scope[1] == 'CV_size_720x1280'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_720x1560'].data" ng-if="$variation_scope[1] == 'CV_size_720x1560'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_728x90'].data" ng-if="$variation_scope[1] == 'CV_size_728x90'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x100'].data" ng-if="$variation_scope[1] == 'CV_size_750x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key like '+_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x200'].data" ng-if="$variation_scope[1] == 'CV_size_750x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_750x300'].data" ng-if="$variation_scope[1] == 'CV_size_750x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_768x240'].data" ng-if="$variation_scope[1] == 'CV_size_768x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_800x250'].data" ng-if="$variation_scope[1] == 'CV_size_800x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_825x100'].data" ng-if="$variation_scope[1] == 'CV_size_825x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_852x640'].data" ng-if="$variation_scope[1] == 'CV_size_852x640'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_910x250'].data" ng-if="$variation_scope[1] == 'CV_size_910x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_930x180'].data" ng-if="$variation_scope[1] == 'CV_size_930x180'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_960x540'].data" ng-if="$variation_scope[1] == 'CV_size_960x540'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_960x1200'].data" ng-if="$variation_scope[1] == 'CV_size_960x1200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x90'].data" ng-if="$variation_scope[1] == 'CV_size_970x90'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x210'].data" ng-if="$variation_scope[1] == 'CV_size_970x210'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x250'].data" ng-if="$variation_scope[1] == 'CV_size_970x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x300'].data" ng-if="$variation_scope[1] == 'CV_size_970x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_970x310'].data" ng-if="$variation_scope[1] == 'CV_size_970x310'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x120'].data" ng-if="$variation_scope[1] == 'CV_size_980x120'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x240'].data" ng-if="$variation_scope[1] == 'CV_size_980x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x250'].data" ng-if="$variation_scope[1] == 'CV_size_980x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x300'].data" ng-if="$variation_scope[1] == 'CV_size_980x300'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_980x600'].data" ng-if="$variation_scope[1] == 'CV_size_980x600'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1000x100'].data" ng-if="$variation_scope[1] == 'CV_size_1000x100'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1020x200'].data" ng-if="$variation_scope[1] == 'CV_size_1020x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1024x81'].data" ng-if="$variation_scope[1] == 'CV_size_1024x81'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1080'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1080'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1920'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1168x250'].data" ng-if="$variation_scope[1] == 'CV_size_1168x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x200'].data" ng-if="$variation_scope[1] == 'CV_size_1200x200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x250'].data" ng-if="$variation_scope[1] == 'CV_size_1200x250'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x628'].data" ng-if="$variation_scope[1] == 'CV_size_1200x628'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1200x1200'].data" ng-if="$variation_scope[1] == 'CV_size_1200x1200'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + thewrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1250x240'].data" ng-if="$variation_scope[1] == 'CV_size_1250x240'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1250x360'].data" ng-if="$variation_scope[1] == 'CV_size_1250x360'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1400x940'].data" ng-if="$variation_scope[1] == 'CV_size_1400x940'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1920x900'].data" ng-if="$variation_scope[1] == 'CV_size_1920x900'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1920x1080'].data" ng-if="$variation_scope[1] == 'CV_size_1920x1080'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <image-picker model="$target_excepts['CV_size_1080x1920_meta_reel'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920_meta_reel'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <image-picker model="$target_excepts['CV_size_1080x1920_meta_story'].data" ng-if="$variation_scope[1] == 'CV_size_1080x1920_meta_story'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>

        <block-info ng-class="{disabled: ($target_excepts[$variation_scope[1]].data)}">
            <p>
                <small ng-if="$target_excepts[$variation_scope[1]].data.sources != null"><q><a ng-click="$target_excepts[$variation_scope[1]].data = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }} </q></small>
                <small><q><a ng-click="$target_excepts[$variation_scope[1]].data = _.omit(_.cloneDeep($target), ['excepts', 'preset'])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / IMAGE SOURCE PICKER -->

<!-- IMAGE CROP PICKER -->
<block-group ng-if="$target && $variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_crop }}">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default' && $target_excepts[$variation_scope[1]].data.sources" ng-class="{disabled: (!$target_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_crop }} *">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<!-- / IMAGE CROP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'quality')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_image_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- IMAGE FORMAT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_format }}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_format }}" ng-class="{disabled: ($variation_scope[1] != 'default')}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE FORMAT PICKER -->

    <!-- IMAGE QUALITY PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE QUALITY PICKER -->

    <!-- IMAGE SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE SCALE PICKER -->

</div>
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$holder.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$holder.enabled">

    <!-- IMAGE EFFECTS PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_trim }}">
            <dropdown-select model="$macros[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_spread }}" ng-class="{disabled: ($macros[$alias_key + '_resize_method'].value == 'none' || $macros[$alias_key + '_resize_method'].value == 'select')}">
            <number-slider model="$macros[$alias_key + '_resize_extend'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_extend }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_sharpen }}">
            <number-slider model="$macros[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }}">
            <number-slider model="$macros[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_trim }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_spread }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value == 'none' || $macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value == 'select')}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_extend'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_extend }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_sharpen }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / IMAGE EFFECTS PICKER -->

</div>
        </div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_video}}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('BG_BV') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('BG_BV') != -1) ? 'BG' : 'BG_BV')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('BG_BV') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'VID'"></data>
        <data ng-if="$target_key = '0'"></data>
        <data ng-if="$alias_key = 'BV'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'quality', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $holder_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$holder_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$holder_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$holder_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[2]"></data>
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][1] = $tab_setup[3]"></data>
<data ng-if="$holder.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->

        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper_group_appear = $wrapper.groups[$wrapper_key + '_' + 'appear']"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$target_excepts = $target.excepts"></data>
<data ng-if="$target_excepts_preset = $target.excepts.preset"></data>
<data ng-if="$target_preset = $holder.presets[$target_key]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $target_excepts && $target_excepts_preset && $target_excepts[$variation_scope[1]] == undefined" ng-init="$target_excepts[$variation_scope[1]] = _.cloneDeep($target_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->
        <data ng-repeat="$key in $variations['EL_orient']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true : $macros_excepts[$key].enabled"></data>
        <data ng-repeat="$key in $variations['CV_tens']" ng-if="$target_excepts && $target_excepts[$key] && _.isUndefined($target_excepts[$key].enabled)" ng-init="$target_excepts[$key].enabled = _.isUndefined($macros_excepts[$key].enabled) ? true :$macros_excepts[$key].enabled"></data>
        <!-- / PATCH TO FIX IMAGE VARIATION BUG - 06.08.2024 -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($target_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($target_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="CV_size_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace($key, 'CV_size_', '') }} {{ ($target_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$target_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$target_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $target_excepts) in $target_excepts">
													<q ng-if="$target_excepts.enabled && $target_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace($key, 'CV_size_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $target_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($target_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VIDEO SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <video-picker model="$holder.layers[0]"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <block-info>
            <p>
                <small ng-if="$holder.layers[0] != null"><q><a ng-click="$holder.layers[0] = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }}</q></small>
                <small ng-if="$frames && $data.editor.frame >= 1"><q><a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_source_1 }}</a> {{ :: $dict.action_clone_source_3 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <video-picker model="$target_excepts['BG_orient_p'].data" ng-if="$variation_scope[1] == 'BG_orient_p'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['BG_orient_s'].data" ng-if="$variation_scope[1] == 'BG_orient_s'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['BG_orient_l'].data" ng-if="$variation_scope[1] == 'BG_orient_l'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_t2'].data" ng-if="$variation_scope[1] == 'CV_tens_t2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_t1'].data" ng-if="$variation_scope[1] == 'CV_tens_t1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_t0'].data" ng-if="$variation_scope[1] == 'CV_tens_t0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_e0'].data" ng-if="$variation_scope[1] == 'CV_tens_e0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_w0'].data" ng-if="$variation_scope[1] == 'CV_tens_w0'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_w1'].data" ng-if="$variation_scope[1] == 'CV_tens_w1'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <video-picker model="$target_excepts['CV_tens_w2'].data" ng-if="$variation_scope[1] == 'CV_tens_w2'"
                      settings="{defaults: $target_preset, cropping: { ratios: ($ratios[$wrapper_key + '_' + $wrapper_group_appear.macros[$wrapper_key + '_place'].value]) } }"
                      no-controls="true" no-mute="true" no-loop="false" no-autoplay="true" no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></video-picker>
        <block-info ng-class="{disabled: ($target_excepts[$variation_scope[1]].data)}">
            <p>
                <small ng-if="$target_excepts[$variation_scope[1]].data.sources != null"><q><a ng-click="$target_excepts[$variation_scope[1]].data = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }} </q></small>
                <small><q><a ng-click="$target_excepts[$variation_scope[1]].data = _.omit(_.cloneDeep($target), ['excepts', 'preset'])">{{ :: $dict.action_clone_source_1 }}</a> {{ :: $dict.action_clone_source_2 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / VIDEO SOURCE PICKER -->

<!-- VIDEO CROP PICKER -->
<block-group ng-if="$target && $variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_crop }}">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default' && $target_excepts[$variation_scope[1]].data.sources" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_crop }} *">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[0]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[1]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[2]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
        <text-field placeholder="{{ :: $dict.label_value }}" model="$target_excepts[$variation_scope[1]].data.params.crop[3]"
                    pattern="^\d+([.]\d{0,10})?$" class="col-1-4"></text-field>
    </block-field>

</block-group>
<!-- / VIDEO CROP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'quality')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_image_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- VIDEO SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_video }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_video }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / VIDEO SCALE PICKER -->

</div>
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$holder.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<!--<div ng-if="$holder.enabled">

</div>-->
        </div>

    </block-group>

</block-group>

<div ng-if="($scope[1] == 'anim')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SETUP PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}" ng-if="$group">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_animation_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / ANIMATION SETUP PICKER -->

<div ng-if="$group.enabled">

    <!-- ANIMATION SPEED IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }}">
            <number-slider model="$macros[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED IN -->

    <!-- ANIMATIONS TRANSITION IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION IN -->

    <!-- ANIMATION SPEED OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED OUT -->

    <!-- ANIMATIONS TRANSITION OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION OUT -->

</div>
</div>

<div ng-if="($scope[1] == 'layout')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_layout_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- ALIGNMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }}" ng-if="$macros[$alias_key + '_justify']">
            <dropdown-select model="$macros[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <dropdown-select model="$macros[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <dropdown-select model="$macros[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }} *" ng-if="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ALIGNMENT PICKER -->

    <!-- OFFSET PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}" ng-if="$variation_scope[1] == 'default'" >
            <number-slider model="$macros[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / OFFSET PICKER -->

    <!-- SIZE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }}">
            <number-slider model="$macros[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }}">
            <number-slider model="$macros[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }}">
            <number-slider model="$macros[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }}">
            <number-slider model="$macros[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }}">
            <number-slider model="$macros[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / SIZE PICKER -->

</div>
</div>

<div ng-if="($scope[1] == 'appear')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_place']">

    <!-- PLACEMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }}">
            <dropdown-select model="$macros[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / PLACEMENT PICKER -->

</div>

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_mask']">

    <!-- MASK PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }}">
            <dropdown-select model="$macros[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }}" ng-class="{disabled: ($macros[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MASK PICKER -->

</div>

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_theme'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_caption }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('PS') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('PS') != -1) ? '' : 'PS')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('PS') != -1)">

        <data ng-if="$frame = $data.banner.layers.CV"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'PS'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['elements', 'anim', 'layout', 'appear'], 'elements', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<block-group ng-if="($scope[1] == 'elements')">

    <block-toggle title="{{ :: $dict.label_button }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('PS_BT') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('PS_BT') != -1) ? 'PS' : 'PS_BT')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('PS_BT') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'TXT'"></data>
        <data ng-if="$target_key = '0'"></data>
        <data ng-if="$alias_key = 'BT'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
        </div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_condition }}" class="toggle"
                  ng-class="{selected: ($data.editor.scope[1].indexOf('PS_CN') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('PS_CN') != -1) ? 'PS' : 'PS_CN')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('PS_CN') != -1)">

        <!-- KEY DEFINITION -->
        <data ng-if="$object_key = 'OBJ'"></data>
        <data ng-if="$holder_key = 'TXT'"></data>
        <data ng-if="$target_key = '1'"></data>
        <data ng-if="$alias_key = 'CN'"></data>
        <!-- / KEY DEFINITION -->

        <!-- TAB SETUP -->
        <data ng-init="$tab_setup = [['source', 'action', 'appear'], 'source', ['appear'], 'appear']"></data>
        <!-- / TAB SETUP -->

        <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

        <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

        <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


        <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

        <div ng-if="($scope[1] == 'source')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
        </div>

        <div ng-if="($scope[1] == 'action')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_action }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_enabled }}" off="{{ :: $dict.label_disabled }}"></toggle-button>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- ELEMENT ACTIONS -->
    <block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_actions }}" class="label"></block-field>

        <block-field title="On Hover">
            <toggle-button model="$macros['gesture_hover'].value" on="{{ :: $dict.action_show_1 }} {{ :: $dict.label_element }}" off="None"></toggle-button>
            <block-info class="inner">
                <p>
                    <small><q>{{ $dict.hint_action }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / ELEMENT ACTIONS -->

</div>
        </div>

        <div ng-if="($scope[1] == 'anim')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
        </div>

        <div ng-if="($scope[1] == 'appear')">
            
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
        </div>

    </block-group>

</block-group>

<div ng-if="($scope[1] == 'anim')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SETUP PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}" ng-if="$group">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_animation_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / ANIMATION SETUP PICKER -->

<div ng-if="$group.enabled">

    <!-- ANIMATION SPEED IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }}">
            <number-slider model="$macros[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_delay }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_delay'].value"
                           min="0" max="1000" length="4" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED IN -->

    <!-- ANIMATIONS TRANSITION IN -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_in }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_in_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION IN -->

    <!-- ANIMATION SPEED OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }}">
            <number-slider model="$macros[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_speed_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_fade }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_opacity'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_transition }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_speed_transform'].value"
                           min="0" max="10000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^\d+"></number-slider>
        </block-field>

    </block-group>
    <!-- / ANIMATION SPEED OUT -->

    <!-- ANIMATIONS TRANSITION OUT -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <number-slider model="$macros[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <number-slider model="$macros[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }}">
            <number-slider model="$macros[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }}">
            <dropdown-select model="$macros[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_anim }} {{ :: $dict.label_transition_out }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_ease }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_ease'].value">
                <option value="linear">{{ :: $dict.label_linear }}</option>
<option value="ease">{{ :: $dict.label_ease }}</option>
<option value="ease-in">{{ :: $dict.label_ease_in }}</option>
<option value="ease-out">{{ :: $dict.label_ease_out }}</option>
<option value="ease-in-out">{{ :: $dict.label_ease_in_out }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_x'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_y'].value"
                           min="-50" max="50" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_z'].value"
                           min="-10" max="10" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-10|-[0-9]|[0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_rotation }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_r'].value"
                           min="-45" max="45" length="3" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-50|-[1-4][0-9]|-[0-9]|[0-9]|[1-4][0-9]|50)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_origin }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_out_origin'].value">
                <option value="left">{{ :: $dict.label_left }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ANIMATIONS TRANSITION OUT -->

</div>
</div>

<div ng-if="($scope[1] == 'layout')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_layout_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- ALIGNMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }}" ng-if="$macros[$alias_key + '_justify']">
            <dropdown-select model="$macros[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <dropdown-select model="$macros[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}">
            <dropdown-select model="$macros[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_alignment }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_justify }} *" ng-if="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_justify'].value">
                <option value="none">None</option>
<option value="inherit">Auto</option>
<option disabled></option>
<option value="start">Start</option>
<option value="center">Center</option>
<option value="end">End</option>
<option disabled></option>
<option value="space-around">Space Around</option>
<option value="space-between">Space Between</option>
<option value="space-evenly">Space Evenly</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_x'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="left">{{ :: $dict.label_left }}</option>
<option value="center">{{ :: $dict.label_center }}</option>
<option value="right">{{ :: $dict.label_right }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_align_y'].value">
                <option value="inherit">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="top">{{ :: $dict.label_top }}</option>
<option value="middle">{{ :: $dict.label_middle }}</option>
<option value="bottom">{{ :: $dict.label_bottom }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / ALIGNMENT PICKER -->

    <!-- OFFSET PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }}">
            <number-slider model="$macros[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }}" ng-if="$variation_scope[1] == 'default'" >
            <number-slider model="$macros[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_offset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_horizontal }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_left }}" center="|" right="{{ :: $dict.label_right }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_vertical }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_offset_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_top }}" center="|" right="{{ :: $dict.label_bottom }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / OFFSET PICKER -->

    <!-- SIZE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }}">
            <number-slider model="$macros[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }}">
            <number-slider model="$macros[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }}">
            <number-slider model="$macros[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }}">
            <number-slider model="$macros[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }}">
            <number-slider model="$macros[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_size }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_all_sides }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_margin'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_top }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_top'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_right }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_right'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_bottom }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_bottom'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_left }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_left'].value"
                           min="-20" max="20" length="3" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-20|-1[0-9]|-[0-9]|[0-9]|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / SIZE PICKER -->

</div>
</div>

<div ng-if="($scope[1] == 'appear')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_place']">

    <!-- PLACEMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }}">
            <dropdown-select model="$macros[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / PLACEMENT PICKER -->

</div>

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_mask']">

    <!-- MASK PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }}">
            <dropdown-select model="$macros[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }}" ng-class="{disabled: ($macros[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MASK PICKER -->

</div>

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_theme'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

    </block-group>

    <block-toggle title="{{ :: $dict.label_logotype }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('LG') != -1)}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('LG') != -1) ? '' : 'LG')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('LG') != -1)">

        <data ng-if="$frame = $data.banner.layers.CV"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'LG'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<div ng-if="($scope[1] == 'source')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <dropdown-select model="$macros[$alias_key + '_type'].value">
            <option value="default">Default</option>

        </dropdown-select>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_type'].value">
            <option value="default">Default</option>

        </dropdown-select>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
</div>

<div ng-if="($scope[1] == 'appear')">
    
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_color'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <!--<block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_color']">
            <dropdown-select model="$macros[$alias_key + '_color'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }}" ng-if="$macros[$alias_key + '_shadow']">
            <dropdown-select model="$macros[$alias_key + '_shadow'].value">
                <SHADOW_OPACITY_OPTIONS></SHADOW_OPACITY_OPTIONS>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <!--<block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_color']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_color'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>-->

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }} *" ng-if="$macros[$alias_key + '_opacity']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].dat[$alias_key + '_shadow'].value">
                <SHADOW_OPACITY_OPTIONS></SHADOW_OPACITY_OPTIONS>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

    </block-group>

</block-group>
<!-- / COMMON ELEMENTS -->

<!-- MODAL ELEMENTS -->
<block-group>

    <block-field title="{{ :: $dict.label_modal_elements }}" class="label"></block-field>

    <block-toggle title="{{ :: $dict.label_popup }}" class="toggle"
                  ng-class="{selected: ($data.editor.scope[1].indexOf('VS') != -1 && !(($data.banner.macros.setup_legal.value == 'v1' || $data.banner.macros.setup_legal.value == 'v2') && ($data.banner.macros.setup_dealer.value == 'v1' || $data.banner.macros.setup_dealer.value == 'v2'))), disabled: (($data.banner.macros.setup_legal.value == 'v1' || $data.banner.macros.setup_legal.value == 'v2') && ($data.banner.macros.setup_dealer.value == 'v1' || $data.banner.macros.setup_dealer.value == 'v2'))}"
                  ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS') != -1) ? '' : 'VS')"></block-toggle>
    <block-group ng-if="($data.editor.scope[1].indexOf('VS') != -1) && !(($data.banner.macros.setup_legal.value == 'v1' || $data.banner.macros.setup_legal.value == 'v2') && ($data.banner.macros.setup_dealer.value == 'v1' || $data.banner.macros.setup_dealer.value == 'v2'))">

        <data ng-if="$frame = $data.banner.layers.CV"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'VS'"></data>
<data ng-if="$data.editor.element = $wrapper_key"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['elements', 'appear'], 'elements', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT VALIDATION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<!-- / SHORTCUT VALIDATION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

<block-group ng-if="($scope[1] == 'dealer')">

  <block-toggle title="{{ :: $dict.label_image }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('VS_DL') != -1)}"
                ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS_DL') != -1) ? 'VS' : 'VS_DL')"></block-toggle>
  <block-group ng-if="($data.editor.scope[1].indexOf('VS_DL') != -1)">

    <!-- KEY DEFINITION -->
    <data ng-if="$object_key = 'OBJ'"></data>
    <data ng-if="$holder_key = 'IMG'"></data>
    <data ng-if="$target_key = '0'"></data>
    <data ng-if="$alias_key = 'DL'"></data>
    <!-- / KEY DEFINITION -->

    <!-- TAB SETUP -->
    <data ng-init="$tab_setup = [['source', 'quality', 'appear'], 'source', ['appear'], 'appear']"></data>
    <!-- / TAB SETUP -->

    <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $holder_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$holder_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$holder_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

    <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$holder_key]"></data>
<!-- / SHORTCUT VALIDATION -->

    <!-- TAB VALIDATION -->
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[2]"></data>
<data ng-if="$holder.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][1] = $tab_setup[3]"></data>
<data ng-if="$holder.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$holder_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->

    <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

    <div ng-if="($scope[1] == 'source')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper_group_appear = $wrapper.groups[$wrapper_key + '_' + 'appear']"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$target_excepts = $target.excepts"></data>
<data ng-if="$target_excepts_preset = $target.excepts.preset"></data>
<data ng-if="$target_preset = $holder.presets[$target_key]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- IMAGE TYPE PICKER -->
<block-group>

    <block-field title="{{ :: $dict.label_type }}">
        <dropdown-select model="$macros[$alias_key + '_type'].value">
            <option value="link">{{ :: $dict.label_link }}</option>
            <option value="image">{{ :: $dict.label_image }}</option>
        </dropdown-select>
    </block-field>

</block-group>
<!-- / IMAGE SOURCE PICKER -->

<!-- LINK SOURCE PICKER -->
<block-group ng-if="$macros[$alias_key + '_type'].value === 'link'">

    <block-field title="{{ :: $dict.label_source }}" class="disabled">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$macros[$alias_key + '_link'].value" pattern="https?\:\/\/.+|\$\[dealer_logo_url\]|\$\{dealer_logo_url\}"></text-field>
    </block-field>

</block-group>
<!-- / LINK SOURCE PICKER -->

<!-- IMAGE SOURCE PICKER -->
<block-group ng-if="$macros[$alias_key + '_type'].value === 'image'">

    <block-field title="{{ :: $dict.label_source }}">
        <image-picker model="$holder.layers[0]"
                      settings="{defaults: $target_preset, cropping: { ratios: {} } }"
                      no-crop="false" no-align="true" no-cover="true" no-load="false" no-excepts="false" no-excepts-orientation="true"></image-picker>
        <block-info>
            <p>
                <small ng-if="$holder.layers[0] != null"><q><a ng-click="$holder.layers[0] = null;">{{ :: $dict.action_remove_source_1 }}</a> {{ :: $dict.action_remove_source_2 }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / IMAGE SOURCE PICKER -->

    </div>

    <div ng-if="($scope[1] == 'quality')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SETUP OVERRIDE PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_preset }}">
        <toggle-button model="$group.enabled" on="{{ :: $dict.label_custom }}" off="{{ :: $dict.label_default }}"></toggle-button>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_image_setup }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SETUP OVERRIDE PICKER -->

<div ng-if="$group.enabled">

    <!-- IMAGE FORMAT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_format }}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_format }}" ng-class="{disabled: ($variation_scope[1] != 'default')}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="jpeg">JPEG</option>
<option value="png">PNG</option>
<option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE FORMAT PICKER -->

    <!-- IMAGE QUALITY PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE QUALITY PICKER -->

    <!-- IMAGE SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE SCALE PICKER -->

</div>
    </div>

    <div ng-if="($scope[1] == 'appear')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $holder.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $holder.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $holder.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<!--<data ng-init="$variation_scope = [[], $variation_scope[1] ? $variation_scope[1] : 'default']"></data>
<data ng-if="$holder != undefined && $holder.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$variation_scope[0] = $variation_setup"></data>
<data ng-if="$holder == undefined || !$holder.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$variation_scope[0] = ['default']"></data>
<data ng-if="$variation_scope = $variation_scope"></data>-->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $target != undefined && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $target == undefined || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$holder.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$holder.enabled">

    <!-- IMAGE EFFECTS PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <!--<block-field title="{{ :: $dict.label_trim }}">
            <dropdown-select model="$macros[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <!--<block-field title="{{ :: $dict.label_size }}">
            <number-slider model="$macros[$alias_key + '_size'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <!--<block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_sharpen }}">
            <number-slider model="$macros[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }}">
            <number-slider model="$macros[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <!--<block-field title="{{ :: $dict.label_trim }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_resize_method'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="select">{{ :: $dict.label_trim_by_asset_cropping }}</option>
<option value="holder">{{ :: $dict.label_trim_by_element_dimensions }}</option>
<option value="canvas">{{ :: $dict.label_trim_by_creative_canvas }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_resize }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <!--<block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_sharpen }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_sharpen'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_blur }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_blur'].value"
                           min="0" max="20" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10|1[0-9]|20)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / IMAGE EFFECTS PICKER -->

</div>
    </div>

  </block-group>

  <block-toggle title="{{ :: $dict.label_title }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('VS_DN') != -1)}"
                ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS_DN') != -1) ? 'VS' : 'VS_DN')"></block-toggle>
  <block-group ng-if="($data.editor.scope[1].indexOf('VS_DN') != -1)">

    <!-- KEY DEFINITION -->
    <data ng-if="$object_key = 'OBJ'"></data>
    <data ng-if="$holder_key = 'TXT'"></data>
    <data ng-if="$target_key = '1'"></data>
    <data ng-if="$alias_key = 'DN'"></data>
    <!-- / KEY DEFINITION -->

    <!-- TAB SETUP -->
    <data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
    <!-- / TAB SETUP -->

    <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

    <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

    <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


    <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

    <div ng-if="($scope[1] == 'source')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
    </div>

    <div ng-if="($scope[1] == 'anim')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- ANIMATION SKIP PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_skip }}">
        <toggle-button model="$macros[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_skip }} *">
        <toggle-button model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_anim_skip'].value" on="{{ :: $dict.label_skip_identical_source }}" off="{{ :: $dict.label_anim_always }}"></toggle-button>
    </block-field>

</block-group>
<!-- / ANIMATION SKIP PICKER -->
    </div>

    <div ng-if="($scope[1] == 'appear')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
    </div>

  </block-group>

  <block-toggle title="{{ :: $dict.label_info }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('VS_DD') != -1)}"
                ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS_DD') != -1) ? 'VS' : 'VS_DD')"></block-toggle>
  <block-group ng-if="($data.editor.scope[1].indexOf('VS_DD') != -1)">

    <!-- KEY DEFINITION -->
    <data ng-if="$object_key = 'OBJ'"></data>
    <data ng-if="$holder_key = 'TXT'"></data>
    <data ng-if="$target_key = '2'"></data>
    <data ng-if="$alias_key = 'DD'"></data>
    <!-- / KEY DEFINITION -->

    <!-- TAB SETUP -->
    <data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
    <!-- / TAB SETUP -->

    <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

    <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

    <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


    <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

    <div ng-if="($scope[1] == 'source')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
    </div>

    <div ng-if="($scope[1] == 'appear')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
    </div>

  </block-group>

</block-group>

<block-group ng-if="($scope[1] == 'elements')">

  <block-toggle title="{{ :: $dict.label_title }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('VS_VA') != -1)}"
                ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS_VA') != -1) ? 'VS' : 'VS_VA')"></block-toggle>
  <block-group ng-if="($data.editor.scope[1].indexOf('VS_VA') != -1)">

    <!-- KEY DEFINITION -->
    <data ng-if="$object_key = 'OBJ'"></data>
    <data ng-if="$holder_key = 'TXT'"></data>
    <data ng-if="$target_key = '3'"></data>
    <data ng-if="$alias_key = 'VA'"></data>
    <!-- / KEY DEFINITION -->

    <!-- TAB SETUP -->
    <data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
    <!-- / TAB SETUP -->

    <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

    <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

    <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


    <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

    <div ng-if="($scope[1] == 'source')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
    </div>

    <div ng-if="($scope[1] == 'appear')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
    </div>

  </block-group>

  <block-toggle title="{{ :: $dict.label_disclaimer }}" class="toggle" ng-class="{selected: ($data.editor.scope[1].indexOf('VS_VB') != -1)}"
                ng-click="$data.editor.scope[1] = (($data.editor.scope[1].indexOf('VS_VB') != -1) ? 'VS' : 'VS_VB')"></block-toggle>
  <block-group ng-if="($data.editor.scope[1].indexOf('VS_VB') != -1)">

    <!-- KEY DEFINITION -->
    <data ng-if="$object_key = 'OBJ'"></data>
    <data ng-if="$holder_key = 'TXT'"></data>
    <data ng-if="$target_key = '4'"></data>
    <data ng-if="$alias_key = 'VB'"></data>
    <!-- / KEY DEFINITION -->

    <!-- TAB SETUP -->
    <data ng-init="$tab_setup = [['source', 'appear'], 'source', ['appear'], 'appear']"></data>
    <!-- / TAB SETUP -->

    <!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $target_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$target_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$target_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

    <!-- SHORTCUT VALIDATION -->
<data ng-if="$holder = $wrapper.layers[$wrapper_key  + '_' + $object_key].layers[$wrapper_key + '_' + $holder_key]"></data>
<data ng-if="$target = $holder.layers[$target_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$target_key]"></data>
<!-- / SHORTCUT VALIDATION -->

    <!-- TAB VALIDATION -->
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[2]"></data>
<data ng-if="$target.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][1] = $tab_setup[3]"></data>
<data ng-if="$target.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$target_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


    <block-menu class="tabs">
    <a ng-repeat="$tab in $tab_setup[0]" ng-click="$scope[1] = $tab" ng-class="{selected: ($scope[1] == $tab), disabled: (_.indexOf($scope[0], $tab) == -1)}">{{ ::  $dict['label_' + $tab] }}</a>
</block-menu>

    <div ng-if="($scope[1] == 'source')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- SOURCE PICKER -->
<block-group ng-if="$variation_scope[1] == 'default'">

    <block-field title="{{ :: $dict.label_source }}">
        <text-area model="$macros[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$frames.model.frames[$data.editor.frame].layers[$wrapper_key] = _.cloneDeep($frames.model.frames[$data.editor.frame - 1].layers[$wrapper_key])">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_3 }}
                </q></small>
            </p>
            <p>
                <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

    <block-field title="{{ :: $dict.label_source }} *">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_source'].value"></text-area>
        <block-info>
            <p ng-if="$frames && $data.editor.frame >= 1">
                <small><q>
                    <a ng-click="$macros_excepts[$variation_scope[1]].data[$wrapper_key + '_source'].value = $macros[$wrapper_key + '_source'].value">{{ :: $dict.action_clone_element_1 }}</a> {{ :: $dict.action_clone_element_2 }}
                </q></small>
            </p>
            <p>
                <small><q>
                    <small><q>{{ :: $dict.hint_text_area }} {{ :: $dict.hint_text_macros }}</q></small>
                </q></small>
            </p>
        </block-info>
    </block-field>

</block-group>
<!-- / SOURCE PICKER -->
    </div>

    <div ng-if="($scope[1] == 'appear')">
      
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $target.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $target.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $target.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations[$alias_key + '_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$target != undefined && $target.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$target == undefined || !$target.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$target.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$target.enabled">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }}">
            <dropdown-select model="$macros[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

<!--        <block-field title="{{ :: $dict.label_size }}">-->
<!--            <number-slider model="$macros[$alias_key + '_size'].value"-->
<!--                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"-->
<!--                           pattern="^(-[0-2]|[0-6])$"></number-slider>-->
<!--            <block-info>-->
<!--                <p>-->
<!--                    <small><q>{{ $dict.hint_text_size }}</q></small>-->
<!--                </p>-->
<!--            </block-info>-->
<!--        </block-field>-->

        <block-field title="{{ :: $dict.label_size }}">
            <dropdown-select model="$macros[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ :: $dict.hint_text_size }} {{ :: $dict.hint_text_size_adjust_1}} <a ng-click="$data.editor.scope[0] = 1; $data.editor.scope[2] = 'texts'">{{ :: $dict.label_texts }}</a> {{ :: $dict.hint_text_size_adjust_2}}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }}">
            <dropdown-select model="$macros[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }}">
            <dropdown-select model="$macros[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_font }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_font'].value">
                <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
            </dropdown-select>
        </block-field>

        <!--<block-field title="{{ :: $dict.label_size }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value"
                           min="-2" max="6" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^(-[0-2]|[0-6])$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>-->

        <block-field title="{{ :: $dict.label_size }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size'].value">
                <option value="$[CV_TXT_size_h1]">{{ :: $dict.label_huge }}</option>
<option value="$[CV_TXT_size_h2]">{{ :: $dict.label_large }}</option>
<option value="$[CV_TXT_size_h3]">{{ :: $dict.label_medium }}</option>
<option value="$[CV_TXT_size_p]">{{ :: $dict.label_normal }}</option>
<option value="$[CV_TXT_size_h4]">{{ :: $dict.label_small }}</option>
<option value="$[CV_TXT_size_h5]">{{ :: $dict.label_tiny }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_scale }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_scale'].value">
                <option value="rem">{{ :: $dict.label_absolute }}</option>
                <option value="em">{{ :: $dict.label_relative }}</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_text_size_auto }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_font_transform }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_trans'].value">
                <option value="none">{{ :: $dict.label_none }}</option>
                <option value="uppercase">{{ :: $dict.label_uppercase }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
    </div>

  </block-group>

</block-group>

<div ng-if="($scope[1] == 'appear')">
  
<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['EL_orient'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<!-- VISIBILITY PICKER -->
<block-group ng-class="{disabled: ($variation_scope[1] != 'default')}">

    <block-field title="{{ :: $dict.label_visibility }}">
        <toggle-button model="$wrapper.enabled" on="{{ :: $dict.label_visible }}" off="{{ :: $dict.label_hidden }}"></toggle-button>
    </block-field>

</block-group>
<!-- / VISIBILITY PICKER -->

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_place']">

    <!-- PLACEMENT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }}">
            <dropdown-select model="$macros[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_placement }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_placement }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_place'].value">
                <option value="fill">Fill Entire Element</option>
                <option value="fit">Fit Into Focus Area</option>
            </dropdown-select>
            <block-info ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data)}">
                <p>
                    <small><q>{{ $dict.hint_asset_place }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / PLACEMENT PICKER -->

</div>

<div ng-if="$wrapper.enabled && $macros[$alias_key + '_mask']">

    <!-- MASK PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }}">
            <dropdown-select model="$macros[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }}" ng-class="{disabled: ($macros[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_mask }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_type }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value">
                <option value="none">{{ :: $dict.label_disabled }}</option>
<option value="auto">{{ :: $dict.label_auto }}</option>
<optgroup label="Radial">
    <option value="circle">{{ :: $dict.label_mask_radial_vague }}</option>
    <option value="circle_sharp">{{ :: $dict.label_mask_radial_sharp }}</option>
</optgroup>
<optgroup label="Square">
    <option value="_mask_linear_all_">{{ :: $dict.label_mask_square_vague }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_horizontal }}">
    <option value="linear_l_">{{ :: $dict.label_left }}</option>
    <option value="linear_rl_">{{ :: $dict.label_left }} {{ :: $dict.label_and }} {{ :: $dict.label_right }}</option>
    <option value="linear_r_">{{ :: $dict.label_right }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_vertical }}">
    <option value="linear_t_">{{ :: $dict.label_top }}</option>
    <option value="linear_tb_">{{ :: $dict.label_top }} {{ :: $dict.label_and }} {{ :: $dict.label_bottom }}</option>
    <option value="linear_b_">{{ :: $dict.label_bottom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_stretch }} *" ng-class="{disabled: ($macros_excepts[$variation_scope[1]].data[$alias_key + '_mask'].value == 'none')}">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_mask_mode'].value">
                <option value="default">{{ :: $dict.label_mask_to_crop_area }}</option>
                <option value="natural">{{ :: $dict.label_mask_to_asset_dimensions }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / MASK PICKER -->

</div>

<div ng-if="$wrapper.enabled && ($macros[$alias_key + '_theme'] || $macros[$alias_key + '_overflow'] || $macros[$alias_key + '_opacity'] || $macros[$alias_key + '_shadow'])">

    <!-- STYLE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }}" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }}" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }}" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_color }} *" ng-if="$macros[$alias_key + '_theme']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="dark">{{ :: $dict.label_dark }}</option>
                <option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overflow }} *" ng-if="$macros[$alias_key + '_overflow']">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_overflow'].value">
                <option value="hidden">{{ :: $dict.label_hidden }}</option>
                <option value="visible">{{ :: $dict.label_visible }}</option>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_opacity }} *" ng-if="$macros[$alias_key + '_opacity']">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_opacity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
        </block-field>

    </block-group>
    <!-- / STYLE PICKER -->

</div>
</div>

    </block-group>

</block-group>
<!-- / MODAL ELEMENTS -->

    </block>
    <!-- / ELEMENTS -->

    <!-- SETTINGS -->
    <block ng-if="$data.editor.scope[0] == 1">

        <block-group>

            <block-field title="{{ :: $dict.label_lading_page }}" class="label"></block-field>

            <block-toggle title="{{ :: $dict.label_destination }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('destination') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'destination') ? '' : 'destination')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('destination') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-group>

    <block-field title="URL {{ :: $dict.label_declaration }}">
        <toggle-button model="$data.banner.clicktag.override" on="Override Ad Server" off="{{ :: $dict.label_disabled }}"></toggle-button>
        <block-info>
            <p>
                <small><q>Override ad server settings in order to define landing page destination URL from content editor.</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>

<block-group ng-if="$data.banner.clicktag.override">

    <block-field title="{{ :: $dict.label_destination }} URL">
        <text-field placeholder="URL" model="$data.banner.clicktag.url" pattern="https?\:\/\/.+|\$\[dest_url\]|\$\{dest_url\}"></text-field>
    </block-field>

    <block-field ng-repeat="($frame, $index) in $data.banner.layers.CV.layers.SQ.frames" title="{{ :: $dict.label_destination }} URL #{{ ($index + 1) }}" ng-class="{disabled: ($data.banner.macros['feed_0'].value && $data.banner.layers.CV.layers.SQ.frames[$index].groups['SQ_feed'].macros['SQ_feed_' + 'CL'].value)}">
        <text-field placeholder="{{ $data.banner.clicktag.url }}" model="$data.banner.layers.CV.layers.SQ.frames[$index].clicktag.url" pattern="https?\:\/\/.+|\$\[dest_url\]|\$\{dest_url\}"></text-field>
    </block-field>

</block-group>


            </div>

            <block-toggle title="{{ :: $dict.label_tagging}}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('tagging') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'tagging') ? '' : 'tagging')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('tagging') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-group>

    <block-field title="UTM Builder">
        <toggle-button model="$data.banner.clicktag.synchronise" on="Merge UTM Parameters" off="{{ :: $dict.label_disabled }}"></toggle-button>
        <block-info>
            <p>
                <small><q>
                    Merge custom UTM parameters with destination URL.
                </q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="UTM Encoder" ng-if="$data.banner.clicktag.synchronise">
        <toggle-button model="$data.banner.clicktag.encode" on="Encode Special Characters" off="{{ :: $dict.label_disabled }}"></toggle-button>
        <block-info>
            <p>
                <small><q>Convert tagging parameter's special characters into format that can be transmitted overlay the Internet.</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>

<block-group ng-if="$data.banner.clicktag.synchronise">

    <block-field title="UTM Parameters" class="label"></block-field>

    <block-field title="Campaign">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.utm_campaign"></text-field>
        <block-info>
            <p>
                <small><q>Strategic campaign (e.g. summer_sale).</q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="Content">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.utm_condition"></text-field>
        <block-info>
            <p>
                <small><q>Content details for A/B testing (e.g. red_button).</q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="Medium">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.utm_medium"></text-field>
        <block-info>
            <p>
                <small><q>Marketing sharing medium (e.g. display, banner).</q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="{{ :: $dict.label_source }}">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.utm_source"></text-field>
        <block-info>
            <p>
                <small><q>Source of traffic (e.g. google, referral).</q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="Term">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.utm_term"></text-field>
        <block-info>
            <p>
                <small><q>Terms suggested for paid search.</q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="Keyword">
        <text-field placeholder="{{ :: $dict.label_value }}" model="$data.banner.definition.keyword"></text-field>
        <block-info>
            <p>
                <small><q>Keyword added to click tag (e.g. frame index).</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>



            </div>

        </block-group>

        <block-group>

            <block-toggle title="{{ :: $dict.label_setup }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('setup') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'setup') ? '' : 'setup')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('setup') != -1)">

                <block-group>

    <block-field title="{{ :: $dict.label_region }}">
        <dropdown-select model="$data.banner.macros.region.value">
            <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="no">Norway</option>
        </dropdown-select>
    </block-field>

    <block-field title="{{ :: $dict.label_brand }}">
        <dropdown-select model="$data.banner.macros.brand.value">
            <option value="auto">{{ :: $dict.label_auto }}</option>
<option disabled></option>
<option value="eika">Eika</option>
<option value="eidsberg">Eidsberg Sparebank</option>
        </dropdown-select>
    </block-field>

    <!--<block-field title="{{ :: $dict.label_purpose }}">
        <dropdown-select model="$data.banner.props.purpose.name">
            <option value="none">Auto</option>
<option value="some">Social Media</option>
        </dropdown-select>
    </block-field>-->

</block-group>

<block-group>

    <block-field title="{{ :: $dict.label_compression }}">
        <dropdown-select model="$data.banner.macros.compression.value">
            <option value="auto">{{ :: $dict.label_auto }}</option>
<option value="${compression}">{{ :: $dict.label_customisable }}</option>
<option disabled></option>
<option value="high">{{ :: $dict.label_high }}</option>
<option value="medium">{{ :: $dict.label_medium }}</option>
<option value="low">{{ :: $dict.label_low }}</option>
        </dropdown-select>
        <block-info>
            <p>
                <small><q>{{ $dict.hint_compression }}</q></small>
            </p>
        </block-info>
    </block-field>

</block-group>


            </div>

            <block-toggle title="{{ :: $dict.label_timeline }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('timeline') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'timeline') ? '' : 'timeline')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('timeline') != -1)">

                <block-group>

    <block-field title="Stop Banner" class="label"></block-field>

    <block-field title="After Time">
        <number-slider model="$data.banner.params.stop.after"
                       min="0" max="30000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                       pattern="^\d+"></number-slider>
    </block-field>

    <block-field title="On Frame">
        <dropdown-select model="$data.banner.layers.CV.layers.SQ.params.stop.on">
            <option value="timer">Timer Frame</option>
            <option value="first">First Frame</option>
            <option value="last">Last Frame</option>
            <!--<optgroup label="Selected Frame">
                <option ng-repeat="($frame, $index) in $data.banner.layers.CV.layers.SQ.frames" value="{{$index}} ">Frame #{{($index + 1)}}</option>
            </optgroup>-->
        </dropdown-select>
    </block-field>

</block-group>

<block-group>

    <block-field title="Pause Sequence" class="label"></block-field>

    <block-field title="After Frame">
        <number-slider model="$data.banner.layers.CV.layers.SQ.params.pause.after.frame"
                       min="0" max="30" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                       pattern="^([0-9]|[1-2][0-9]|30)$"></number-slider>
    </block-field>

    <block-field title="After Time">
        <number-slider model="$data.banner.layers.CV.layers.SQ.params.pause.after.time"
                       min="0" max="30000" length="5" index="ms" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                       pattern="^\d+"></number-slider>
    </block-field>

    <block-field title="After Loop">
        <number-slider model="$data.banner.layers.CV.layers.SQ.params.pause.after.loop"
                       min="0" max="30" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                       pattern="^([0-9]|[1-2][0-9]|30)$"></number-slider>
    </block-field>

</block-group>

            </div>

            <block-toggle title="{{ :: $dict.label_layout }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('appear') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'appear') ? '' : 'appear')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('appear') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'CV'"></data>
<data ng-if="$data.editor.element = ''"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['appear'], 'appear', ['appear'], 'appear']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<data ng-if="$scope[1] = $tab_setup[3]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<div ng-if="$group.enabled">

    <!-- DEFAULT THEME -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_default }} {{ :: $dict.label_appear }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_layout }}">
            <dropdown-select model="$macros[$alias_key + '_layout'].value">
                <option value="boxed">Boxed Message</option>
<option value="framed">Boxed Background</option>
<option value="default">Full Background</option>
<option value="isolated">Isolated Background</option>

            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_default }} {{ :: $dict.label_appear }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_layout }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_layout'].value">
                <option value="boxed">Boxed Message</option>
<option value="framed">Boxed Background</option>
<option value="default">Full Background</option>
<option value="isolated">Isolated Background</option>

            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / DEFAULT THEME -->

</div>

            </div>

            <block-toggle title="{{ :: $dict.label_colors }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('colors') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'colors') ? '' : 'colors')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('colors') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'CV'"></data>
<data ng-if="$data.editor.element = ''"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['colors'], 'colors', ['colors'], 'colors']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<data ng-if="$scope[1] = $tab_setup[3]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<div ng-if="$group.enabled">

    <!-- DEFAULT THEME -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_default }} {{ :: $dict.label_preset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_theme }}">
            <dropdown-select model="$macros[$alias_key + '_theme'].value">
                <option value="dark">{{ :: $dict.label_dark }}</option>
<option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_default }} {{ :: $dict.label_preset }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_theme }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_theme'].value">
                <option value="dark">{{ :: $dict.label_dark }}</option>
<option value="light">{{ :: $dict.label_light }}</option>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / DEFAULT THEME -->

    <!-- DEFAULT COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_logotype }}">
            <dropdown-select model="$macros['LG_lg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_message }}">
            <dropdown-select model="$macros['MS_st'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_button }}">
            <dropdown-select model="$macros['BS_bt'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_logotype }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['LG_lg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_message }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['MS_st'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_button }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['BS_bt'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / DEFAULT COLORS -->

    <!-- SUPPORTING COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_supporting }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }}">
            <dropdown-select model="$macros['UL_bg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }}">
            <dropdown-select model="$macros['IL_bg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }}">
            <dropdown-select model="$macros['OL_gr'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }}">
            <dropdown-select model="$macros['CV_sh'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_supporting }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['UL_bg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['IL_bg'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto">{{ :: $dict.label_auto }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_theme }}">
    <option value="dark">{{ :: $dict.label_dark }}</option>
    <option value="light">{{ :: $dict.label_light }}</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['OL_gr'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }} *">
            <dropdown-select model="$macros_excepts[$variation_scope[1]].data['CV_sh'].value">
                <optgroup label="{{ :: $dict.label_auto }}">
    <option value="auto_a10">{{ :: $dict.label_auto }} 10%</option>
    <option value="auto_a20">{{ :: $dict.label_auto }} 20%</option>
    <option value="auto_a40">{{ :: $dict.label_auto }} 40%</option>
    <option value="auto_a60">{{ :: $dict.label_auto }} 60%</option>
    <option value="auto_a80">{{ :: $dict.label_auto }} 80%</option>
    <option value="auto_a90">{{ :: $dict.label_auto }} 90%</option>
    <option value="auto_a100">{{ :: $dict.label_auto }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_black }}">
    <option value="black_a10">{{ :: $dict.label_black }} 10%</option>
    <option value="black_a20">{{ :: $dict.label_black }} 20%</option>
    <option value="black_a40">{{ :: $dict.label_black }} 40%</option>
    <option value="black_a60">{{ :: $dict.label_black }} 60%</option>
    <option value="black_a80">{{ :: $dict.label_black }} 80%</option>
    <option value="black_a90">{{ :: $dict.label_black }} 90%</option>
    <option value="black_a100">{{ :: $dict.label_black }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_white }}">
    <option value="white_a10">{{ :: $dict.label_white }} 10%</option>
    <option value="white_a20">{{ :: $dict.label_white }} 20%</option>
    <option value="white_a40">{{ :: $dict.label_white }} 40%</option>
    <option value="white_a60">{{ :: $dict.label_white }} 60%</option>
    <option value="white_a80">{{ :: $dict.label_white }} 80%</option>
    <option value="white_a90">{{ :: $dict.label_white }} 90%</option>
    <option value="white_a100">{{ :: $dict.label_white }} 100%</option>
</optgroup>
<optgroup label="{{ :: $dict.label_other }}">
    <option value="transparent">{{ :: $dict.label_transparent }} </option>
    <option value="custom">{{ :: $dict.label_custom }}</option>
</optgroup>
            </dropdown-select>
        </block-field>

    </block-group>
    <!-- / SUPPORTING COLORS -->

    <!-- CUSTOM COLORS -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_custom }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }}">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros['UL_bg_custom'].value"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }}">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros['IL_bg_custom'].value"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }}">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros['OL_gr_custom_0'].value" class="col-1-2"></color-field>
            <color-field placeholder="HEX / RGB / RGBA" model="$macros['OL_gr_custom_1'].value" class="col-1-2"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }}">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros['CV_sh_custom'].value"></color-field>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_custom }} {{ :: $dict.label_colors }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_underlay }} *">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros_excepts[$variation_scope[1]].data['UL_bg_custom'].value"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_interlay }} *">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros_excepts[$variation_scope[1]].data['IL_bg_custom'].value"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_overlay }} *">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros_excepts[$variation_scope[1]].data['OL_gr_custom_0'].value" class="col-1-2"></color-field>
            <color-field placeholder="HEX / RGB / RGBA" model="$macros_excepts[$variation_scope[1]].data['OL_gr_custom_1'].value" class="col-1-2"></color-field>
        </block-field>

        <block-field title="{{ :: $dict.label_shadow }} *">
            <color-field placeholder="HEX / RGB / RGBA" model="$macros_excepts[$variation_scope[1]].data['CV_sh_custom'].value"></color-field>
        </block-field>

    </block-group>
    <!-- / CUSTOM COLORS -->

</div>

            </div>

            <block-toggle title="{{ :: $dict.label_fonts }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('fonts') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'fonts') ? '' : 'fonts')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('fonts') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!----------------------------------------------------------------------------------------------------------------->

<!-- FONT LOAD SETUP -->
<block-group>

    <block-field title="Font Preload" class="label"></block-field>

    <block-field title="Primary">
        <dropdown-select model="$frame.params.wait.fonts[0]">
            <option value="">{{ :: $dict.label_none }}</option>
            <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
        </dropdown-select>
    </block-field>

    <block-field title="Secondary">
        <dropdown-select model="$frame.params.wait.fonts[1]">
            <option value="">{{ :: $dict.label_none }}</option>
            <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
        </dropdown-select>
    </block-field>

    <block-field title="Tertiary">
        <dropdown-select model="$frame.params.wait.fonts[2]">
            <option value="">{{ :: $dict.label_none }}</option>
            <option ng-repeat="$font in $fonts" value="{{ $font[0] }}">{{ $font[1] }}</option>
        </dropdown-select>
    </block-field>

</block-group>
<!-- / FONT LOAD SETUP -->

            </div>

            <block-toggle title="{{ :: $dict.label_texts }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('texts') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'texts') ? '' : 'texts')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('texts') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'CV'"></data>
<data ng-if="$data.editor.element = ''"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['texts'], 'texts', ['texts'], 'texts']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<data ng-if="$scope[1] = $tab_setup[3]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<div ng-if="$group.enabled">

    <data ng-if="$alias_key = $wrapper_key + '_TXT'"></data>

    <!-- TEXT SIZE SETUP -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_text }} {{ :: $dict.label_sizes }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_huge }}">
            <number-slider model="$macros[$alias_key + '_size_h1'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_large }}">
            <number-slider model="$macros[$alias_key + '_size_h2'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_medium }}">
            <number-slider model="$macros[$alias_key + '_size_h3'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_normal}}">
            <number-slider model="$macros[$alias_key + '_size_p'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_small }}">
            <number-slider model="$macros[$alias_key + '_size_h4'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_tiny }}">
            <number-slider model="$macros[$alias_key + '_size_h5'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_text }} {{ :: $dict.label_sizes }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_huge }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_h1'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_large }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_h2'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_medium }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_h3'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_normal}} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_p'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_small }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_h4'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_tiny }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_size_h5'].value"
                           min="8" max="48" length="2" index="" left="{{ :: $dict.label_small }}" center="|" right="{{ :: $dict.label_large }}"
                           pattern="^([8-9]|1[0-9]|2[0-9]|3[0-9]|4[0-8])$"></number-slider>
        </block-field>

    </block-group>
    <!-- / TEXT SIZE SETUP -->

    <!-- TEXT SPACING SETUP -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_text }} {{ :: $dict.label_spacing }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_global }}">
            <number-slider model="$macros[$alias_key + '_spacing'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_title }}">
            <number-slider model="$macros[$alias_key + '_spacing_MA'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_subtitle }}">
            <number-slider model="$macros[$alias_key + '_spacing_MB'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_button }}">
            <number-slider model="$macros[$alias_key + '_spacing_BT'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_text }} {{ :: $dict.label_style }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_global }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_spacing'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_title }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_spacing_MA'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_subtitle }}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_spacing_MB'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

        <block-field title="{{ :: $dict.label_button }}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_spacing_BT'].value"
                           min="-2" max="4" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^(-[0-1]|[0-4])$"></number-slider>
        </block-field>

    </block-group>
    <!-- / TEXT SPACING SETUP -->

</div>

            </div>

            <block-toggle title="{{ :: $dict.label_images }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('images') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'images') ? '' : 'images')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('images') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'CV'"></data>
<data ng-if="$data.editor.element = ''"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['images'], 'images', ['images'], 'images']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<data ng-if="$scope[1] = $tab_setup[3]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<div ng-if="$group.enabled">

    <data ng-if="$alias_key = $wrapper_key + '_IMG'"></data>

    <!-- IMAGE FORMAT PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_format }}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="jpeg">JPEG</option>
                <option value="png">PNG</option>
                <option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_format }}" ng-class="{disabled: ($variation_scope[1] != 'default')}">
            <dropdown-select model="$macros[$alias_key + '_format'].value">
                <option value="auto">{{ :: $dict.label_auto }}</option>
                <option value="jpeg">JPEG</option>
                <option value="png">PNG</option>
                <option value="webp">WEBP</option>
            </dropdown-select>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_image_format }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE FORMAT PICKER -->

    <!-- IMAGE QUALITY PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_quality_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_quality_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE QUALITY PICKER -->

    <!-- IMAGE SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_image }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_element_quality }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / IMAGE SCALE PICKER -->

</div>

            </div>

            <block-toggle title="{{ :: $dict.label_videos }}" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('videos') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'videos') ? '' : 'videos')"></block-toggle>
            <div ng-if="($data.editor.scope[2].indexOf('videos') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<!-- KEY DEFINITION -->
<data ng-if="$wrapper_key = 'CV'"></data>
<data ng-if="$data.editor.element = ''"></data>
<data ng-if="$alias_key = $wrapper_key"></data>
<!-- / KEY DEFINITION -->

<!-- TAB SETUP -->
<data ng-init="$tab_setup = [['videos'], 'videos', ['videos'], 'videos']"></data>
<!-- / TAB SETUP -->

<!-- STATE VALIDATION -->
<data ng-if="$nav[$data.editor.scope[0]][0] = $wrapper_key"></data>
<data ng-if="$nav[$data.editor.scope[0]][1][$wrapper_key] == undefined" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key] = [$tab_setup[0], $tab_setup[1], {}]"></data>
<!-- / STATE VALIDATION -->

<!-- SHORTCUT DEFINITION -->
<data ng-if="$wrapper = $frame.layers[$wrapper_key]"></data>
<data ng-if="$scope = $nav[$data.editor.scope[0]][1][$wrapper_key]"></data>
<data ng-if="$scope[1] = $tab_setup[3]"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- TAB VALIDATION -->
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[2]"></data>
<data ng-if="$wrapper.enabled == false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][1] = $tab_setup[3]"></data>
<data ng-if="$wrapper.enabled != false" ng-init="$nav[$data.editor.scope[0]][1][$wrapper_key][0] = $tab_setup[0]"></data>
<!-- TAB VALIDATION -->


<!-- SHORTCUT DEFINITION -->
<data ng-if="$group = $wrapper.groups[$alias_key + '_' + $scope[1]]"></data>
<data ng-if="$macros = $wrapper.groups[$alias_key + '_' + $scope[1]].macros"></data>
<data ng-if="$macros_excepts = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts"></data>
<data ng-if="$macros_excepts_preset = $wrapper.groups[$alias_key + '_' + $scope[1]].macros.excepts.preset"></data>
<!-- / SHORTCUT DEFINITION -->

<!-- UPDATE VARIATION PRESET VALUES -->
<data ng-if="$macros_excepts_preset && !$macros_excepts_preset.data[$key]" ng-repeat="($key, $item) in $macros" ng-init="$macros_excepts_preset.data[$key] = { value: $macros[$key].value }"></data>
<data ng-if="$macros_excepts && $item.value != $macros[$key].value" ng-repeat="($key, $item) in $macros_excepts_preset.data" ng-init="$item.value = $macros[$key].value"></data>
<!-- / UPDATE VARIATION PRESET VALUES -->

<!-- VARIATION SETUP -->
<data ng-init="$variation_setup = _.concat(['default'], $variations['CV_tens'], $variations['CV_scale'], $variations['CV_mode'], $variations['CV_size'])"></data>
<!-- /VARIATION SETUP -->

<!-- VALIDATE VARIATION SETUP -->
<data ng-if="$scope[2][$scope[1]] == undefined" ng-init="$scope[2][$scope[1]] = [$variation_setup, 'default']"></data>
<data ng-if="$wrapper != undefined && $wrapper.enabled && $group != undefined && $macros_excepts != undefined" ng-init="$scope[2][$scope[1]][0] = $variation_setup"></data>
<data ng-if="$wrapper == undefined || !$wrapper.enabled || $group == undefined || $macros_excepts == undefined" ng-init="$scope[2][$scope[1]][0] = ['default']"></data>
<data ng-if="$variation_scope = $scope[2][$scope[1]]"></data>
<!-- VALIDATE VARIATION SETUP -->

<!-- VARIATION PICKER -->
<block-group ng-class="{disabled: _.size($variation_scope[0]) <= 1}">

    <block-field title="{{ :: $dict.label_variation }} @">

        <!-- CLONE SELECTED VARIATION PRESET -->
        <data ng-if="$variation_scope[1] != 'default' && $macros_excepts && $macros_excepts_preset && $macros_excepts[$variation_scope[1]] == undefined" ng-init="$macros_excepts[$variation_scope[1]] = _.cloneDeep($macros_excepts_preset)"></data>
        <!-- / CLONE SELECTED VARIATION PRESET -->

        <!-- VARIATION OPTIONS SELECTOR -->
        <dropdown-select model="$variation_scope[1]" ng-class="{'col-2-3' : ($macros_excepts && $variation_scope[1] != 'default')}">
            <optgroup label="{{ :: $dict.label_default }}">
                <option value="default">{{ :: $dict.label_default }}</option>
            </optgroup>
            <!--<optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations[$target_key + '_orient'] && $target_key + '_orient' !== $wrapper_key + '_orient'">
                <option ng-repeat="$key in $variations[$target_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_wrapper_orientation }}" ng-if="$variations[$wrapper_key + '_orient']">
                <option ng-repeat="$key in $variations[$wrapper_key + '_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>-->
            <optgroup label="{{ :: $dict.label_target_orientation }}" ng-if="$variations['EL_orient']">
                <option ng-repeat="$key in $variations['EL_orient']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_tension }}" ng-if="$variations['CV_tens']">
                <option ng-repeat="$key in $variations['CV_tens']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_scale }}" ng-if="$variations['CV_scale']">
                <option ng-repeat="$key in $variations['CV_scale']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_state }}" ng-if="$variations['CV_mode']">
                <option ng-repeat="$key in $variations['CV_mode']" value="{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : $dict['label_' + $key.split('_').slice(1).join('_')] }} {{ ($macros_excepts[$key].enabled ? '*' : '') }}</option>
            </optgroup>
            <optgroup label="{{ :: $dict.label_creative_size }}" ng-if="$variations['CV_size']">
                <option ng-repeat="$key in $variations['CV_size']" value="name_{{ $key }}" ng-disabled="_.indexOf($variation_scope[0], $key) == -1">{{ :: $dict['label_' + $key] ? $dict['label_' + $key] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') }} {{ ($macros_excepts['CV_size_' + $key].enabled ? '*' : '') }}</option>
            </optgroup>
        </dropdown-select>
        <div ng-if="$macros_excepts && $variation_scope[1] != 'default'" class="col-1-3">
            <toggle-button model="$macros_excepts[$variation_scope[1]].enabled" on="On" off="Off"></toggle-button>
        </div>
        <!-- / VARIATION OPTIONS SELECTOR -->

        <!-- NO VARIATIONS ARE AVAILABLE -->
        <block-info ng-if="(_.size($variation_setup) <= 1)">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_not_available }}
                </q></small>
            </p>
        </block-info>

        <!--VARIATIONS ARE AVAILABLE, DEFAULT IS SELECTED -->
        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_required }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="(_.size($variation_setup) > 1 && _.size($variation_scope[0]) <= 1) && $variation_scope[1] == 'default'">
            <p>
                <small><q>
                    {{ :: $dict.hint_variation_default_is }}
                </q></small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p>
                <small>
                    <q>{{ :: $dict.hint_variations_active }}</q>
                    <span ng-repeat="($key, $macros_excepts) in $macros_excepts">
													<q ng-if="$macros_excepts.enabled && $macros_excepts.data"><a ng-click="$variation_scope[1] = $key">{{ $dict['label_' + $key] ? $dict['label_' + $key] : ($dict['label_' + $key.split('_').slice(1).join('_')] ? $dict['label_' + $key.split('_').slice(1).join('_')] : _.replace(_.replace($key, 'CV_size_', ''), 'name_', '') ) }}</a>, </q>
												</span>
                    <q><a ng-click="$variation_scope[1] = 'default'">{{ :: $dict.label_default }}</a></q>
                </small>
            </p>
            <p>
                <small>
                    <q>
                        <a ng-click="$macros.excepts = { preset: $macros_excepts_preset }; $variation_scope[1] = 'default';">{{ :: $dict.action_remove_variations_1}}</a> {{ :: $dict.action_remove_variations_2}}
                    </q>
                </small>
            </p>
        </block-info>

        <block-info ng-if="($macros_excepts && _.size($variation_scope[0]) > 1)">
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] == 'default'">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_default_is }}
                    </q>
                </small>
            </p>
            <p ng-if="$relations[$variation_scope[1]]">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_asterisks }}
                    </q>
                </small>
                <small>
                    <q ng-repeat="$relation in $relations[$variation_scope[1]]"><span ng-if="_.includes($sizes, $relation)"><a ng-click="$editor.changePreviewSize($relation)">{{ :: $relation }}</a>, </span></q>
                    <q><a ng-click="$editor.changePreviewSize('RxR')">RxR</a></q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') !== -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
            <p ng-if="!$relations[$variation_scope[1]] && $variation_scope[1] != 'default' && $variation_scope[1].indexOf('_size_') == -1">
                <small>
                    <q>
                        {{ :: $dict.hint_variation_override }} {{ :: $dict.hint_variation_dynamic }} {{ :: $dict.hint_variation_apply_selected_asterisks }}
                    </q>
                </small>
            </p>
        </block-info>

    </block-field>

</block-group>
<!-- / VARIATION PICKER -->

<!----------------------------------------------------------------------------------------------------------------->

<div ng-if="$group.enabled">

    <data ng-if="$alias_key = $wrapper_key + '_VID'"></data>

    <!-- VIDEO SCALE PICKER -->
    <block-group ng-if="$variation_scope[1] == 'default'">

        <block-field title="{{ :: $dict.label_video }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }}">
            <number-slider model="$macros[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }}" ng-class="{'disabled': ($macros[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <block-group ng-if="$variation_scope[1] != 'default'" ng-class="{disabled: (!$macros_excepts[$variation_scope[1]].enabled)}">

        <block-field title="{{ :: $dict.label_video }} {{ :: $dict.label_scale }}" class="label"></block-field>

        <block-field title="{{ :: $dict.label_level }} *">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_level }}</q></small>
                </p>
            </block-info>
        </block-field>

        <block-field title="{{ :: $dict.label_optimisation }} *" ng-class="{'disabled': ($macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_level'].value <= 0)}">
            <number-slider model="$macros_excepts[$variation_scope[1]].data[$alias_key + '_ratio_velocity'].value"
                           min="0" max="10" length="2" index="" left="{{ :: $dict.label_min }}" center="|" right="{{ :: $dict.label_max }}"
                           pattern="^([0-9]|10)$"></number-slider>
            <block-info>
                <p>
                    <small><q>{{ $dict.hint_scale_velocity }}</q></small>
                </p>
            </block-info>
        </block-field>

    </block-group>
    <!-- / VIDEO SCALE PICKER -->

</div>

            </div>

        </block-group>

        <block-group>

            <block-field title="Editing Tools" class="label"></block-field>

            <block-toggle title="Preview" class="toggle" ng-class="{selected: ($data.editor.scope[2].indexOf('preview') != -1)}"
                          ng-click="$data.editor.scope[2] = (($data.editor.scope[2] == 'preview') ? '' : 'preview')"></block-toggle>
            <block-group ng-if="($data.editor.scope[2].indexOf('preview') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field title="Mode">
    <dropdown-select model="$data.banner.props.mode.name">
        <option value="live">Live</option>
        <option value="capture-gif">Snapshot (GIF)</option>
        <option value="capture">Snapshot (JPEG)</option>
        <option value="debug">Debug</option>
    </dropdown-select>
    <block-info>
        <p>
            <small><q>
                Live preview mode mode represents creative the way end user will see it. This mode will be automatically set for all live adverts.
            </q></small>
        </p>
    </block-info>
    <block-info>
        <p>
            <small><q>
                Snapshot (GIF) preview mode will display only key frames of the sequence, all animations will be disabled.
            </q></small>
        </p>
    </block-info>
    <block-info>
        <p>
            <small><q>
                Snapshot (JPEG) preview mode will display exact moment on the timeline when the snapshot is taken, all animations will be disabled.
            </q></small>
        </p>
    </block-info>
    <block-info>
        <p>
            <small><q>
                Debug preview mode enables features that will help you to edit content with ease. Selected element bounds will be highlighted with color. Selected frame from the sequence will shown immediately in the creative preview.
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="{{ :: $dict.label_frame }}" ng-class="{disabled: ($data.banner.props.mode.name != 'debug')}">
    <toggle-button model="$data.editor.jump" on="Go to Selected Frame" off="Play from the First Frame"></toggle-button>
    <block-info ng-class="{disabled: ($exceptions[$scope[3][$scope[1]][1]].data)}">
        <p>
            <small><q>If debug mode is enabled, you will land on the selected frame in the preview by skipping frames in the sequence.</q></small>
        </p>
    </block-info>
</block-field>

<block-field title="Pause" ng-class="{disabled: ($data.banner.props.mode.name != 'debug')}">
    <toggle-button model="$data.editor.pause" on="Pause at Selected Frame" off="Play Normally"></toggle-button>
    <block-info ng-class="{disabled: ($exceptions[$scope[3][$scope[1]][1]].data)}">
        <p>
            <small><q>If debug mode is enabled, you will be held on the selected frame in the preview and sequence frame change will not happen.</q></small>
        </p>
    </block-info>
</block-field>

<block-field title="Grid" ng-class="{disabled: ($data.banner.props.mode.name != 'debug')}">
    <toggle-button model="$data.editor.grid" on="Show Grid" off="Hide Grid"></toggle-button>
    <block-info ng-class="{disabled: ($exceptions[$scope[3][$scope[1]][1]].data)}">
        <p>
            <small><q>If debug mode is enabled, you will be able to see the layout grid.</q></small>
        </p>
    </block-info>
</block-field>


            </block-group>

        </block-group>

    </block>
    <!-- / SETTINGS -->

    <!-- MACROS -->
    <block ng-if="$data.editor.scope[0] == 2">

        <block-group>

            <block-field title="{{ :: $dict.label_global }} {{ :: $dict.label_variables }}" class="label"></block-field>

            <block-toggle title="{{ :: $dict.label_message }}" class="toggle" ng-class="{selected: ($data.editor.scope[3].indexOf('message') != -1)}"
                          ng-click="$data.editor.scope[3] = (($data.editor.scope[3] == 'message') ? '' : 'message')"></block-toggle>
            <block-group ng-if="($data.editor.scope[3].indexOf('message') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field title="$[button]">
    <text-field placeholder="{{ :: $dict.label_value }}" model="$frame.macros.button.value"></text-field>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.button.value = '${button}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[rate]">
    <text-field placeholder="{{ :: $dict.label_value }}" model="$frame.macros.rate.value"></text-field>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.rate.value = '${rate}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[price]">
    <text-field placeholder="{{ :: $dict.label_value }}" model="$frame.macros.price.value"></text-field>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.price.value = '${price}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[cur]">
    <text-field placeholder="{{ :: $dict.label_value }}" model="$frame.macros.cur.value"></text-field>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.cur.value = '${cur}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<div ng-repeat="$key in ['1', '2', '3', '4', '5']">

    <block-field title="$[message_{{ $key }}]">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros['message_' + $key].value"></text-area>
        <block-info>
            <p>
                <small><q>
                    <a ng-click="$frame.macros['message_' + $key].value = '${message_' + $key + '}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
                </q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="$[message_{{ $key }}_l]">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros['message_' + $key + '_l'].value"></text-area>
        <block-info>
            <p>
                <small><q>
                    <a ng-click="$frame.macros['message_' + $key + '_l'].value = '${message_' + $key + '_l}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
                </q></small>
            </p>
        </block-info>
    </block-field>

    <block-field title="$[message_{{ $key }}_p]">
        <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros['message_' + $key + '_p'].value"></text-area>
        <block-info>
            <p>
                <small><q>
                    <a ng-click="$frame.macros['message_' + $key + '_p'].value = '${message_' + $key + '_p}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
                </q></small>
            </p>
        </block-info>
    </block-field>

</div>


            </block-group>

            <block-toggle title="{{ :: $dict.label_legal }}" class="toggle" ng-class="{selected: ($data.editor.scope[3].indexOf('legal') != -1)}"
                          ng-click="$data.editor.scope[3] = (($data.editor.scope[3] == 'legal') ? '' : 'legal')"></block-toggle>
            <block-group ng-if="($data.editor.scope[3].indexOf('legal') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field title="$[terms]">
    <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros.terms.value"></text-area>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.terms.value = '${terms}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[condition]">
    <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros.condition.value"></text-area>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.condition.value = '<q>* - ${condition}</q>'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[disclaimer]">
    <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros.disclaimer.value"></text-area>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros.disclaimer.value = '${disclaimer}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>


            </block-group>

            <block-toggle title="{{ :: $dict.label_custom }}" class="toggle" ng-class="{selected: ($data.editor.scope[3].indexOf('custom') != -1)}"
                          ng-click="$data.editor.scope[3] = (($data.editor.scope[3] == 'custom') ? '' : 'custom')"></block-toggle>
            <block-group ng-if="($data.editor.scope[3].indexOf('custom') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field ng-repeat="$key in ['1', '2', '3', '4', '5']" title="$[var_{{ $key }}]">
    <text-field placeholder="{{ :: $dict.label_value }}" model="$frame.macros['var_' + $key].value"></text-field>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros['var_' + $key].value = '${var_' + $key + '}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field ng-repeat="$key in ['6', '7', '8', '9', '10']" title="$[var_{{ $key }}]">
    <text-area placeholder="{{ :: $dict.label_value }}" model="$frame.macros['var_' + $key].value"></text-area>
    <block-info>
        <p>
            <small><q>
                <a ng-click="$frame.macros['var_' + $key].value = '${var_' + $key + '}'">{{ :: $dict.action_set_value_1 }}</a> {{ :: $dict.action_set_value_2 }}
            </q></small>
        </p>
    </block-info>
</block-field>

            </block-group>

            <block-field title="{{ :: $dict.label_system }} {{ :: $dict.label_variables }}" class="label"></block-field>

            <block-toggle title="{{ :: $dict.label_feed }}" class="toggle" ng-class="{selected: ($data.editor.scope[3].indexOf('feed') != -1)}"
                          ng-click="$data.editor.scope[3] = (($data.editor.scope[3] == 'feed') ? '' : 'feed')"></block-toggle>
            <block-group ng-if="($data.editor.scope[3].indexOf('feed') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field title="$[feed_key]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Value from the feed, e.g. "260,70".
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[feed_key_#]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Split value from the feed (if applicable), e.g. "260" and "70".
            </q></small>
        </p>
    </block-info>
</block-field>

            </block-group>

            <block-toggle title="{{ :: $dict.label_system }}" class="toggle" ng-class="{selected: ($data.editor.scope[3].indexOf('system') != -1)}"
                          ng-click="$data.editor.scope[3] = (($data.editor.scope[3] == 'system') ? '' : 'system')"></block-toggle>
            <block-group ng-if="($data.editor.scope[3].indexOf('system') != -1)">

                <data ng-if="$frame = $data.banner"></data>

<block-field title="$[name]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Banner name, e.g. "Medium Rectangle".
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[size]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Banner size, e.g. "300x250" or "980x150".
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[vendor]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Ad vendor, e.g. "google" or "xandr".
            </q></small>
        </p>
    </block-info>
</block-field>

<block-field title="$[domain]">
    <text-field placeholder="{{ :: $dict.label_dynamic }} {{ :: $dict.label_value }}" disabled="true"></text-field>
    <block-info>
        <p>
            <small><q>
                Ad domain, e.g. "bbc.com" or "vg.no".
            </q></small>
        </p>
    </block-info>
</block-field>



            </block-group>

        </block-group>

    </block>
    <!-- / MACROS -->

</div>

<style>

    .input-text-field-char-addon .addon {
        color: #9fa7bb;
        font-size: 10px !important;
    }

    textarea {
        transition: min-height 0.25s ease, height 0.25s ease;
    }

    block-toggle.disabled span.label.toggle-label,
    block-toggle.disabled .toggle:hover span.label.toggle-label {
        color: #9fa7bb !important;
    }

    block-toggle.disabled span.toggle-icon svg,
    block-toggle.disabled .toggle:hover span.toggle-icon svg {
        fill: #9fa7bb !important;
    }

    block-toggle.disabled,
    block-toggle.disabled * {
        cursor: default !important;
    }

</style>
<!-- Initialise navigation -->
<data ng-init="
$nav = [
	['', {}],
	['', {}],
	['', {}]
];"></data>

<!-- Pick REGION value from brand data, if available -->
<data ng-if="($data.banner.macros.region.value === 'auto' && $data.$templateSettings.region)" ng-init="$data.banner.macros.region.value = $data.$templateSettings.region"></data>

<!-- Pick BRAND value from brand data, if available -->
<data ng-if="($data.banner.macros.brand.value === 'auto' && $data.$templateSettings.brand)" ng-init="$data.banner.macros.brand.value = $data.$templateSettings.brand"></data>

<!-- Update selected layer scope -->
<data ng-if="($data.editor.scope[1] === '' || $data.editor.scope[0] !== 0)" ng-init="$data.editor.element = ''"></data>

<!-- Font configuration -->
<data ng-init="$fonts = [
	['font_A_300', 'OpenSans 300'],
	['font_A_400', 'OpenSans 400'],
	['font_A_600', 'OpenSans 600'],
	['font_B_300', 'Advent Pro 300'],
	['font_B_400', 'Advent Pro 400'],
	['font_B_500', 'Advent Pro 500'],
	['font_B_600', 'Advent Pro 600']
]"></data>

<!-- Size list -->
<data ng-init="$sizes = [{'name':'120x600'},{'name':'140x350'},{'name':'160x80'},{'name':'150x600'},{'name':'160x600'},{'name':'180x500'},{'name':'200x200'},{'name':'200x350'},{'name':'200x600'},{'name':'200x700'},{'name':'240x400'},{'name':'250x250'},{'name':'250x360'},{'name':'250x600'},{'name':'250x800'},{'name':'300x50'},{'name':'300x100'},{'name':'300x200'},{'name':'300x250'},{'name':'300x300'},{'name':'300x600'},{'name':'320x50'},{'name':'320x100'},{'name':'320x160'},{'name':'320x240'},{'name':'320x250'},{'name':'320x280'},{'name':'320x320'},{'name':'320x400'},{'name':'320x480'},{'name':'336x280'},{'name':'350x250'},{'name':'400x600'},{'name':'468x60'},{'name':'468x360'},{'name':'468x480'},{'name':'480x120'},{'name':'480x300'},{'name':'480x480'},{'name':'580x400'},{'name':'600x400'},{'name':'640x320'},{'name':'640x360'},{'name':'640x1000'},{'name':'660x100'},{'name':'712x250'},{'name':'728x90'},{'name':'750x100'},{'name':'750x200'},{'name':'750x300'},{'name':'768x240'},{'name':'800x250'},{'name':'825x110'},{'name':'852x640'},{'name':'910x250'},{'name':'930x180'},{'name':'960x1200'},{'name':'970x90'},{'name':'970x210'},{'name':'970x250'},{'name':'970x300'},{'name':'970x310'},{'name':'980x120'},{'name':'980x240'},{'name':'980x250'},{'name':'980x300'},{'name':'980x600'},{'name':'1000x100'},{'name':'1020x200'},{'name':'1024x81'},{'name':'1080x1080'},{'name':'1080x1920'},{'name':'1080x1920_meta_reel'},{'name':'1080x1920_meta_story'},{'name':'1168x250'},{'name':'1200x200'},{'name':'1200x250'},{'name':'1200x628'},{'name':'1200x1200'},{'name':'1250x360'},{'name':'1400x940'},{'name':'1920x900'},{'name':'1920x1080'}]"></data>
<data ng-init="$sizes = _.pull(_.pull(_.map($data.$availableSizes ? $data.$availableSizes : $sizes, 'name'), 'RxR'), '0x0')"></data>

<!-- Variation list -->
<data ng-init="$variations = {
	CV_size:$sizes,
	CV_scale:['CV_scale_xs','CV_scale_s','CV_scale_m','CV_scale_l','CV_scale_xl'],
	CV_tens:['CV_tens_t2','CV_tens_t1','CV_tens_t0','CV_tens_e0','CV_tens_w0','CV_tens_w1','CV_tens_w2'],
	EL_orient:['EL_orient_p','EL_orient_s','EL_orient_l'],
	CV_mode:['snapshot']
}"></data>

<!-- Size relation list -->
<data ng-init="$relations = {
	CV_tens_t3:[],
	CV_tens_t2:['120x600','150x600','160x600','180x500','200x600','200x700','250x800'],
	CV_tens_t1:['140x350','200x350','250x600','300x600','1080x1920'],
	CV_tens_t0:['240x400','250x360','320x480','400x600','640x1000'],
	CV_tens_e0:['200x200','250x250','300x300','320x280','320x320','320x400','468x480','480x480','960x1200','1080x1080','1200x1200'],
	CV_tens_w0:['300x200','300x250','320x240','320x250','336x280','350x250','468x360','580x400','600x400','852x640','1400x940'],
	CV_tens_w1:['160x80','300x100','320x160','480x300','640x320','640x360','712x250','750x300','970x310','980x600','1200x628','1920x900','1920x1080'],
	CV_tens_w2:['300x50','320x50','320x100','468x60','480x120','660x100','728x90','750x100','750x200','768x240','800x250','825x110','910x250','930x180','970x90','970x210','970x250','970x300','980x120','980x240','980x250','980x300','1000x100','1020x200','1024x81','1168x250','1200x200','1200x250','1250x360'],
	CV_scale_xs:['160x80','300x50','300x100','320x50','320x100','468x60'],
	CV_scale_s:['120x600','140x350','200x200','200x350','250x250','300x200','300x250','320x160','320x240','480x120','660x100','728x90','750x100'],
	CV_scale_m:['150x600','160x600','180x500','200x600','200x700','240x400','250x360','250x600','300x300','320x250','320x280','320x320','320x400','320x480','336x280','350x250','480x300','750x200','825x110','970x90','980x120','1000x100','1024x81'],
	CV_scale_l:['250x800','300x600','400x600','468x360','468x480','480x480','580x400','600x400','640x320','640x360','712x250','750x300','768x240','800x250','910x250','930x180','970x210','970x250','970x300','970x310','980x240','980x250','980x300','1020x200','1168x250','1200x200','1200x250'],
	CV_scale_xl:['640x1000','852x640','960x1200','980x600','1080x1080','1080x1920','1200x628','1200x1200','1250x360','1400x940','1920x900','1920x1080'],
}"></data>

<!-- Image placement ratios -->
<data ng-init="$ratios = {
	BG_fill: {
        '120x600':{label:'120x600',value:'120x300'},'140x350':{label:'140x350',value:'140x175'},'160x80':{label:'160x80',value:'80x80'},'150x600':{label:'150x600',value:'150x300'},'160x600':{label:'160x600',value:'160x300'},'180x500':{label:'180x500',value:'180x250'},'200x200':{label:'200x200',value:'200x100'},'200x350':{label:'200x350',value:'200x175'},'200x600':{label:'200x600',value:'200x300'},'200x700':{label:'200x700',value:'200x350'},'240x400':{label:'240x400',value:'240x200'},'250x250':{label:'250x250',value:'250x125'},'250x360':{label:'250x360',value:'250x180'},'250x600':{label:'250x600',value:'250x300'},'250x800':{label:'250x800',value:'250x400'},'300x50':{label:'300x50',value:'120x50'},'300x100':{label:'300x100',value:'150x100'},'300x200':{label:'300x200',value:'150x200'},'300x250':{label:'300x250',value:'150x250'},'300x300':{label:'300x300',value:'300x150'},'300x600':{label:'300x600',value:'300x300'},'320x50':{label:'320x50',value:'128x50'},'320x100':{label:'320x100',value:'160x100'},'320x160':{label:'320x160',value:'160x160'},'320x240':{label:'320x240',value:'160x240'},'320x250':{label:'320x250',value:'160x250'},'320x280':{label:'320x280',value:'320x140'},'320x320':{label:'320x320',value:'320x160'},'320x400':{label:'320x400',value:'320x200'},'320x480':{label:'320x480',value:'320x240'},'336x280':{label:'336x280',value:'168x280'},'350x250':{label:'350x250',value:'175x250'},'400x600':{label:'400x600',value:'400x300'},'468x60':{label:'468x60',value:'187x60'},'468x360':{label:'468x360',value:'234x360'},'468x480':{label:'468x480',value:'468x240'},'480x120':{label:'480x120',value:'240x120'},'480x300':{label:'480x300',value:'240x300'},'480x480':{label:'480x480',value:'480x240'},'580x400':{label:'580x400',value:'290x400'},'600x400':{label:'600x400',value:'300x400'},'640x320':{label:'640x320',value:'320x320'},'640x360':{label:'640x360',value:'320x360'},'640x1000':{label:'640x1000',value:'640x500'},'660x100':{label:'660x100',value:'264x100'},'712x250':{label:'712x250',value:'356x250'},'728x90':{label:'728x90',value:'291x90'},'750x100':{label:'750x100',value:'300x100'},'750x200':{label:'750x200',value:'375x200'},'750x300':{label:'750x300',value:'375x300'},'768x240':{label:'768x240',value:'384x240'},'800x250':{label:'800x250',value:'400x250'},'825x110':{label:'825x110',value:'330x110'},'852x640':{label:'852x640',value:'426x640'},'910x250':{label:'910x250',value:'455x250'},'930x180':{label:'930x180',value:'465x180'},'960x1200':{label:'960x1200',value:'960x600'},'970x90':{label:'970x90',value:'388x90'},'970x210':{label:'970x210',value:'485x210'},'970x250':{label:'970x250',value:'485x250'},'970x300':{label:'970x300',value:'485x300'},'970x310':{label:'970x310',value:'485x310'},'980x120':{label:'980x120',value:'392x120'},'980x240':{label:'980x240',value:'490x240'},'980x250':{label:'980x250',value:'490x250'},'980x300':{label:'980x300',value:'490x300'},'980x600':{label:'980x600',value:'490x600'},'1000x100':{label:'1000x100',value:'400x100'},'1020x200':{label:'1020x200',value:'510x200'},'1024x81':{label:'1024x81',value:'410x81'},'1080x1080':{label:'1080x1080',value:'1080x540'},'1080x1920':{label:'1080x1920',value:'1080x960'},'1080x1920_meta_reel':{label:'1080x1920_meta_reel',value:'1080x960'},'1080x1920_meta_story':{label:'1080x1920_meta_story',value:'1080x960'},'1168x250':{label:'1168x250',value:'584x250'},'1200x200':{label:'1200x200',value:'480x200'},'1200x250':{label:'1200x250',value:'600x250'},'1200x628':{label:'1200x628',value:'600x628'},'1200x1200':{label:'1200x1200',value:'1200x600'},'1250x360':{label:'1250x360',value:'625x360'},'1400x940':{label:'1400x940',value:'700x940'},'1920x900':{label:'1920x900',value:'0x0'},'1920x1080':{label:'1920x1080',value:'0x0'},
    },
    BG_fit: {},
	FG_fill: {
        '120x600':{label:'120x600',value:'120x300'},'140x350':{label:'140x350',value:'140x175'},'160x80':{label:'160x80',value:'80x80'},'150x600':{label:'150x600',value:'150x300'},'160x600':{label:'160x600',value:'160x300'},'180x500':{label:'180x500',value:'180x250'},'200x200':{label:'200x200',value:'200x100'},'200x350':{label:'200x350',value:'200x175'},'200x600':{label:'200x600',value:'200x300'},'200x700':{label:'200x700',value:'200x350'},'240x400':{label:'240x400',value:'240x200'},'250x250':{label:'250x250',value:'250x125'},'250x360':{label:'250x360',value:'250x180'},'250x600':{label:'250x600',value:'250x300'},'250x800':{label:'250x800',value:'250x400'},'300x50':{label:'300x50',value:'120x50'},'300x100':{label:'300x100',value:'150x100'},'300x200':{label:'300x200',value:'150x200'},'300x250':{label:'300x250',value:'150x250'},'300x300':{label:'300x300',value:'300x150'},'300x600':{label:'300x600',value:'300x300'},'320x50':{label:'320x50',value:'128x50'},'320x100':{label:'320x100',value:'160x100'},'320x160':{label:'320x160',value:'160x160'},'320x240':{label:'320x240',value:'160x240'},'320x250':{label:'320x250',value:'160x250'},'320x280':{label:'320x280',value:'320x140'},'320x320':{label:'320x320',value:'320x160'},'320x400':{label:'320x400',value:'320x200'},'320x480':{label:'320x480',value:'320x240'},'336x280':{label:'336x280',value:'168x280'},'350x250':{label:'350x250',value:'175x250'},'400x600':{label:'400x600',value:'400x300'},'468x60':{label:'468x60',value:'187x60'},'468x360':{label:'468x360',value:'234x360'},'468x480':{label:'468x480',value:'468x240'},'480x120':{label:'480x120',value:'240x120'},'480x300':{label:'480x300',value:'240x300'},'480x480':{label:'480x480',value:'480x240'},'580x400':{label:'580x400',value:'290x400'},'600x400':{label:'600x400',value:'300x400'},'640x320':{label:'640x320',value:'320x320'},'640x360':{label:'640x360',value:'320x360'},'640x1000':{label:'640x1000',value:'640x500'},'660x100':{label:'660x100',value:'264x100'},'712x250':{label:'712x250',value:'356x250'},'728x90':{label:'728x90',value:'291x90'},'750x100':{label:'750x100',value:'300x100'},'750x200':{label:'750x200',value:'375x200'},'750x300':{label:'750x300',value:'375x300'},'768x240':{label:'768x240',value:'384x240'},'800x250':{label:'800x250',value:'400x250'},'825x110':{label:'825x110',value:'330x110'},'852x640':{label:'852x640',value:'426x640'},'910x250':{label:'910x250',value:'455x250'},'930x180':{label:'930x180',value:'465x180'},'960x1200':{label:'960x1200',value:'960x600'},'970x90':{label:'970x90',value:'388x90'},'970x210':{label:'970x210',value:'485x210'},'970x250':{label:'970x250',value:'485x250'},'970x300':{label:'970x300',value:'485x300'},'970x310':{label:'970x310',value:'485x310'},'980x120':{label:'980x120',value:'392x120'},'980x240':{label:'980x240',value:'490x240'},'980x250':{label:'980x250',value:'490x250'},'980x300':{label:'980x300',value:'490x300'},'980x600':{label:'980x600',value:'490x600'},'1000x100':{label:'1000x100',value:'400x100'},'1020x200':{label:'1020x200',value:'510x200'},'1024x81':{label:'1024x81',value:'410x81'},'1080x1080':{label:'1080x1080',value:'1080x540'},'1080x1920':{label:'1080x1920',value:'1080x960'},'1080x1920_meta_reel':{label:'1080x1920_meta_reel',value:'1080x960'},'1080x1920_meta_story':{label:'1080x1920_meta_story',value:'1080x960'},'1168x250':{label:'1168x250',value:'584x250'},'1200x200':{label:'1200x200',value:'480x200'},'1200x250':{label:'1200x250',value:'600x250'},'1200x628':{label:'1200x628',value:'600x628'},'1200x1200':{label:'1200x1200',value:'1200x600'},'1250x360':{label:'1250x360',value:'625x360'},'1400x940':{label:'1400x940',value:'700x940'},'1920x900':{label:'1920x900',value:'0x0'},'1920x1080':{label:'1920x1080',value:'0x0'},
    },
    FG_fit: {},
	UG_fill: {
        '120x600':{label:'120x600',value:'120x300'},'140x350':{label:'140x350',value:'140x175'},'160x80':{label:'160x80',value:'80x80'},'150x600':{label:'150x600',value:'150x300'},'160x600':{label:'160x600',value:'160x300'},'180x500':{label:'180x500',value:'180x250'},'200x200':{label:'200x200',value:'200x100'},'200x350':{label:'200x350',value:'200x175'},'200x600':{label:'200x600',value:'200x300'},'200x700':{label:'200x700',value:'200x350'},'240x400':{label:'240x400',value:'240x200'},'250x250':{label:'250x250',value:'250x125'},'250x360':{label:'250x360',value:'250x180'},'250x600':{label:'250x600',value:'250x300'},'250x800':{label:'250x800',value:'250x400'},'300x50':{label:'300x50',value:'120x50'},'300x100':{label:'300x100',value:'150x100'},'300x200':{label:'300x200',value:'150x200'},'300x250':{label:'300x250',value:'150x250'},'300x300':{label:'300x300',value:'300x150'},'300x600':{label:'300x600',value:'300x300'},'320x50':{label:'320x50',value:'128x50'},'320x100':{label:'320x100',value:'160x100'},'320x160':{label:'320x160',value:'160x160'},'320x240':{label:'320x240',value:'160x240'},'320x250':{label:'320x250',value:'160x250'},'320x280':{label:'320x280',value:'320x140'},'320x320':{label:'320x320',value:'320x160'},'320x400':{label:'320x400',value:'320x200'},'320x480':{label:'320x480',value:'320x240'},'336x280':{label:'336x280',value:'168x280'},'350x250':{label:'350x250',value:'175x250'},'400x600':{label:'400x600',value:'400x300'},'468x60':{label:'468x60',value:'187x60'},'468x360':{label:'468x360',value:'234x360'},'468x480':{label:'468x480',value:'468x240'},'480x120':{label:'480x120',value:'240x120'},'480x300':{label:'480x300',value:'240x300'},'480x480':{label:'480x480',value:'480x240'},'580x400':{label:'580x400',value:'290x400'},'600x400':{label:'600x400',value:'300x400'},'640x320':{label:'640x320',value:'320x320'},'640x360':{label:'640x360',value:'320x360'},'640x1000':{label:'640x1000',value:'640x500'},'660x100':{label:'660x100',value:'264x100'},'712x250':{label:'712x250',value:'356x250'},'728x90':{label:'728x90',value:'291x90'},'750x100':{label:'750x100',value:'300x100'},'750x200':{label:'750x200',value:'375x200'},'750x300':{label:'750x300',value:'375x300'},'768x240':{label:'768x240',value:'384x240'},'800x250':{label:'800x250',value:'400x250'},'825x110':{label:'825x110',value:'330x110'},'852x640':{label:'852x640',value:'426x640'},'910x250':{label:'910x250',value:'455x250'},'930x180':{label:'930x180',value:'465x180'},'960x1200':{label:'960x1200',value:'960x600'},'970x90':{label:'970x90',value:'388x90'},'970x210':{label:'970x210',value:'485x210'},'970x250':{label:'970x250',value:'485x250'},'970x300':{label:'970x300',value:'485x300'},'970x310':{label:'970x310',value:'485x310'},'980x120':{label:'980x120',value:'392x120'},'980x240':{label:'980x240',value:'490x240'},'980x250':{label:'980x250',value:'490x250'},'980x300':{label:'980x300',value:'490x300'},'980x600':{label:'980x600',value:'490x600'},'1000x100':{label:'1000x100',value:'400x100'},'1020x200':{label:'1020x200',value:'510x200'},'1024x81':{label:'1024x81',value:'410x81'},'1080x1080':{label:'1080x1080',value:'1080x540'},'1080x1920':{label:'1080x1920',value:'1080x960'},'1080x1920_meta_reel':{label:'1080x1920_meta_reel',value:'1080x960'},'1080x1920_meta_story':{label:'1080x1920_meta_story',value:'1080x960'},'1168x250':{label:'1168x250',value:'584x250'},'1200x200':{label:'1200x200',value:'480x200'},'1200x250':{label:'1200x250',value:'600x250'},'1200x628':{label:'1200x628',value:'600x628'},'1200x1200':{label:'1200x1200',value:'1200x600'},'1250x360':{label:'1250x360',value:'625x360'},'1400x940':{label:'1400x940',value:'700x940'},'1920x900':{label:'1920x900',value:'0x0'},'1920x1080':{label:'1920x1080',value:'0x0'},
    },
    UG_fit: {}
};
"></data>

<style>

    div.v3 block .toggle .toggle-label a {
        padding-bottom: 15px;
    }

    div.v3 block-menu.tabs a {
        padding-bottom: 15px;
    }

    div.v3 block .toggle.label.selected .toggle-label a,
    div.v3 block .toggle.selected .label a,
    div.v3 block-menu a.selected,
    div.v3 block-menu.tabs a.selected {
        font-weight: 600 !important;
    }

</style><data ng-init="$dict = {
	hint_text_area: 'Apply no word break (&lt;u&gt;) or no line break (&lt;var&gt;) conditions to specific parts of the text. Separate text with a divider (&lt;hr&gt;). Override text color (&lt;em&gt;, &lt;q&gt;). Override text size (&lt;big&gt;, &lt;small&gt;) or font face (&lt;b&gt;, &lt;i&gt;, &lt;s&gt;), if applicable.',
	hint_text_field: 'Override text color (&lt;em&gt;, &lt;q&gt;). Override text size (&lt;big&gt;, &lt;small&gt;) or font face (&lt;b&gt;, &lt;i&gt;, &lt;s&gt;), if applicable.',
	hint_text_size: 'Text size will not scale up if the source already fills the entire container.',
	hint_text_size_auto: 'Automatic text scaling will apply if relative value is selected.',
	hint_text_size_adjust_1: 'Global text sizes are controlled at',
	hint_text_size_adjust_2: 'settings.',
	hint_theme_adjust_1: 'Global theme is controlled at',
	hint_theme_adjust_2: 'settings.',
	hint_image_size: 'Image size will not scale up if the source already fills the entire container.',
	hint_image_size_auto: 'Automatic image scaling will apply if relative value is selected.',
	hint_text_macros: 'Use macros to insert special elements or dynamic content (e.g., $[feed] or $[var_1]).',
	hint_stacking: 'Optimise text stacking in narrow placements so that elements follow each other on the same line. If element stacking is optimised, less height is required to fit the text.',
	hint_asset_area: 'Select an alternative asset source.',
	hint_asset_place: 'Fill the entire element container, even if the asset has to be stretched or its edges cut. Alternatively, fit the asset into the focus area so that it is fully visible. Use the asset cropping feature to select the area you want to focus on.',
	hint_asset_blur: 'The blur effect may not be supported by older web browsers.',
	hint_animation_setup: 'The default animation configuration is defined by the template.',
	hint_animation_skip: 'Skip animation if you have the same asset source on different frames and you don\'t want to animate the element again with every frame change.',
	hint_variation_default_is: 'The default variation applies to all sizes and conditions unless overridden by an alternative variation.',
	hint_variation_default_required: 'A default variation is required before setting alternatives.',
	hint_variation_override: 'An alternative variation will override the default.',
	hint_variation_not_available: 'Variations are not available for this property.',
	hint_variation_non_default: 'This option is only available for non-default variations.',
	hint_variation_apply_asterisks: 'The selected variation will apply to appropriate sizes and attributes marked with an asterisk symbol (*):',
	hint_variation_apply_selected_asterisks: 'The selected variation will apply to attributes marked with an asterisk symbol (*).',
	hint_variations_active: 'Active variations:',
	hint_variation_apply: 'The selected variation will apply to appropriate sizes:',
	hint_variation_dynamic: 'The orientation size index is not available for elements with dynamic or adjustable layout properties.',
	hint_layout_setup: 'The default layout configuration is defined by the template.',
	hint_image_setup: 'Default quality is controlled at global advert settings.',
	hint_image_resize: 'Optimise the advert\'s weight by trimming the edges of image assets.',
	hint_image_format: '',
	hint_quality_extend: 'Trim or extend the edges of the asset. Ensure precise asset trimming at uneven pixel placements by using a positive value.',
	hint_scale_level: 'Adjust the asset\'s scale to enhance rendering quality on retina displays. Be aware that higher values can significantly increase the advert\'s weight.',
	hint_scale_velocity: 'Adjust the asset\'s scale for bigger placeholder areas progressively. The higher the value, the more significant the scaling reduction on bigger placeholders. This is effective for complying with strict size constraints.',
	hint_quality_level: 'Adjust the asset\'s quality to balance advert weight. A zero value corresponds to the default setup in application resources.',
	hint_quality_velocity: 'Adjust the asset\'s quality for higher image resolutions progressively. The higher the value, the more significant the quality reduction on bigger images. This is effective for complying with strict size constraints.',
	hint_feed_selector: 'Apply feed source at',
	hint_feed_warning: 'Feed source is not set in the global settings.',
	hint_feed_active: 'The source from feed will be used.',
	hint_element_visibility: '',
	hint_action: 'If an action is enabled, the advert will navigate to the modal frame when the user hovers over or clicks on the element.',
	hint_blank_frame: 'This frame type does not contain nested elements.',
	hint_modular_frame: 'This frame will be visible on selected sizes if certain conditions are met.',
	hint_shared_frame: 'This frame displays related non sequenced elements if certain conditions are met.',
	hint_shared_frame_1: 'This frame displays',
	hint_shared_frame_2: 'element(s) if certain conditions are met.',
	hint_setup_layout: 'Automatic mode will apply the layout configuration according to a predefined regional setup. Customisable mode allows the end user to select the value on their own.',
	hint_compression: 'The higher the compression value, the more foreground images will be disabled in the sequence. This works in combination with frame prioritisation, which can be set for each frame in the sequence. Customisable mode allows the end user to select the value on their own.',
	label_variation: 'Variation',
	label_blank: 'Blank',
	label_purpose: 'Purpose',
	label_wrapper_orientation: 'Wrapper Orientation',
	label_target_orientation: 'Element Orientation',
	label_creative_tension: 'Creative Tension',
	label_creative_scale: 'Creative Scale',
	label_creative_size: 'Creative Size',
	label_creative_state: 'Creative State',
	label_common_elements: 'Common Elements',
	label_sequenced_elements: 'Sequenced Elements',
	label_regular: 'Regular',
	label_special: 'Special',
	label_popup: 'Popup',
	label_dialog: 'Dialog',
	label_modal: 'Modal',
	label_modal_elements: 'Modal Elements',
	label_compression: 'Compression',
	label_default: 'Default',
	label_gradient: 'Gradient',
	label_gradients: 'Gradients',
	label_color: 'Color',
	label_colors: 'Colors',
	label_source: 'Source',
	label_sources: 'Sources',
	label_element: 'Element',
	label_elements: 'Elements',
	label_canvas: 'Canvas',
	label_banner: 'Banner',
	label_macro: 'Macro',
	label_macros: 'Macros',
	label_variables: 'Variables',
	label_exclusion: 'Exclusion',
	label_inclusion: 'Inclusion',
	label_link: 'Link',
	label_links: 'Links',
	label_feed: 'Feed',
	label_feeds: 'Feeds',
	label_font: 'Font',
	label_fonts: 'Fonts',
	label_action: 'Action',
	label_actions: 'Actions',
	label_theme: 'Theme',
	label_appear: 'Appearance',
	label_quality: 'Quality',
	label_scale: 'Scale',
	label_split: 'Split',
	label_info: 'Info',
	label_if_applicable: 'If Applicable',
	label_warranty: 'Warranty',
	label_embedded: 'Embedded',
	label_relative: 'Relative',
	label_emission: 'Emission',
	label_font_scale: 'Font Scale',
	label_font_face: 'Font Face',
	label_font_size: 'Font Size',
	label_font_transform: 'Transform',
	label_element_quality: 'Element Quality',
	label_image_quality: 'Image Quality',
	label_video_quality: 'Video Quality',
	label_opacity: 'Opacity',
	label_overflow: 'Overflow',
	label_setup: 'Setup',
	label_visible: 'Visible',
	label_hidden: 'Hidden',
	label_layout: 'Layout',
	label_anim: 'Animation',
	label_effects: 'Effects',
	label_settings: 'Settings',
	label_visibility: 'Visibility',
	label_destination: 'Destination',
	label_lading_page: 'Landing Page',
	label_declaration: 'Declaration',
	label_tagging: 'Tagging',
	label_placement: 'Placement',
	label_shadow: 'Shadow',
	label_mask: 'Mask',
	label_skip: 'Skip',
	label_skip_identical_source: 'Skip Identical Source',
	label_anim_always: 'Always Animate',
	label_auto: 'Auto',
	label_timeline: 'Timeline',
	label_configuration: 'Configuration',
	label_region: 'Region',
	label_brand: 'Brand',
	label_global: 'Global',
	label_size: 'Size',
	label_spacing: 'Spacing',
	label_height: 'Height',
	label_width: 'Width',
	label_sizes: 'Sizes',
	label_small: 'Small',
	label_large: 'Large',
	label_min: 'Min',
	label_max: 'Max',
	label_stretch: 'Stretch',
	label_alignment: 'Alignment',
	label_offset: 'Offset',
	label_horizontal: 'Horizontal',
	label_vertical: 'Vertical',
	label_rotation: 'Rotation',
	label_origin: 'Origin',
	label_transparent: 'Transparent',
	label_light: 'Light',
	label_dark: 'Dark',
	label_black: 'Black',
	label_white: 'White',
	label_red: 'Red',
	label_green: 'Green',
	label_green_light: 'Green (Light)',
	label_blue: 'Blue',
	label_center: 'Center',
	label_top: 'Top',
	label_bottom: 'Bottom',
	label_left: 'Left',
	label_right: 'Right',
	label_and: 'and',
	label_middle: 'Middle',
	label_linear: 'Linear',
	label_fade: 'Fade',
	label_delay: 'Delay',
	label_ease: 'Ease',
	label_ease_in: 'Ease In',
	label_ease_out: 'Ease Out',
	label_ease_in_out: 'Ease In Out',
	label_speed: 'Speed',
	label_speed_in: 'Speed In',
	label_speed_out: 'Speed Out',
	label_transition: 'Transition',
	label_transition_in: 'Transition In',
	label_transition_out: 'Transition Out',
	label_text: 'Text',
	label_texts: 'Texts',
	label_icon: 'Icon',
	label_icons: 'Icons',
	label_image: 'Image',
	label_images: 'Images',
	label_video: 'Video',
	label_videos: 'Videos',
	label_style: 'Style',
	label_element_style: 'Element Style',
	label_trim: 'Trim',
	label_spread: 'Spread',
	label_sharpen: 'Sharpen',
	label_blur: 'Blur',
	label_format: 'Format',
	label_crop: 'Crop',
	label_disabled: 'Disabled',
	label_enabled: 'Enabled',
	label_uppercase: 'Uppercase',
	label_absolute: 'Absolute',
	label_relative: 'Relative',
	label_preset: 'Preset',
	label_line: 'Line',
	label_highlight: 'Highlight',
	label_optimisation: 'Optimisation',
	label_value: 'Value',
	label_dynamic: 'Dynamic',
	label_panoramic: 'Panoramic',
	label_arrangement: 'Arrangement',
	label_compact: 'Compact',
	label_justify: 'Justify',
	label_start: 'Start',
	label_end: 'End',
    label_always: 'Always',
	label_trim_by_asset_cropping: 'By Asset Cropping',
	label_trim_by_element_dimensions: 'By Element Dimensions',
	label_trim_by_creative_canvas: 'By Creative Canvas',
	label_mask_to_crop_area: 'To Crop Area',
	label_mask_to_asset_dimensions: 'To Asset Dimensions',
	label_mask_radial_vague: 'Radial Vague',
	label_mask_radial_sharp: 'Radial Sharp',
	label_mask_square_vague: 'Square Vague',
	label_all_sides: 'All Sides',
	label_on_side: 'On Side',
	label_space_around: 'Space Around',
	label_space_between: 'Space Between',
	label_space_evenly: 'Space Evenly',
    label_filter: 'Filter',
    label_filters: 'Filters',
    label_filter_split_all: 'Split at All Sizes',
    label_filter_split_limited: 'Split at Limited Sizes',
    label_filter_split_micro: 'Split at Micro Sizes',
    label_filter_split_small_micro: 'Split at Small and Micro Sizes',
    label_filter_include_limited: 'Include at Limited Sizes',
    label_filter_exclude_limited: 'Exclude at Limited Sizes',
    label_filter_include_micro: 'Include at Micro Sizes',
    label_filter_exclude_micro: 'Exclude at Micro Sizes',
    label_filter_include_small_micro: 'Include at Small and Micro Sizes',
    label_filter_exclude_small_micro: 'Exclude at Small and Micro Sizes',
    label_filter_include_large_huge: 'Include at Large and Huge Sizes',
    label_filter_exclude_large_huge: 'Exclude at Large and Huge Sizes',
    label_filter_include_snapshot: 'Include in Snapshot Mode',
    label_filter_exclude_snapshot: 'Exclude in Snapshot Mode',
	label_none: 'None',
	label_customisable: 'Customisable',
	label_priority: 'Priority',
	label_label: 'Label',
	label_button: 'Button',
	label_message: 'Message',
	label_title: 'Title',
	label_subtitle: 'Subtitle',
	label_model: 'Model',
	label_price: 'Price',
	label_underlay: 'Underlay',
	label_interlay: 'Interlay',
	label_overlay: 'Overlay',
	label_background: 'Background',
	label_foreground: 'Foreground',
	label_disclaimer: 'Disclaimer',
	label_logotype: 'Logotype',
	label_wordmark: 'Wordmark',
	label_caption: 'Caption',
	label_description: 'Description',
	label_explanation: 'Explanation',
	label_condition: 'Condition',
	label_dealer: 'Dealer',
	label_retailer: 'Retailer',
	label_vendor: 'Vendor',
	label_supporting: 'Supporting',
	label_call: 'Call',
	label_call_to_action: 'Call to Action',
	label_terms: 'Terms',
	label_legal: 'Legal',
	label_badge: 'Badge',
	label_badges: 'Badges',
	label_frame: 'Frame',
	label_frames: 'Frames',
	label_detail: 'Detail',
	label_details: 'Details',
	label_system: 'System',
	label_communication: 'Communication',
	label_signature: 'Signature',
	label_product: 'Product',
	label_vehicle: 'Vehicle',
	label_type: 'Type',
	label_level: 'Level',
	label_custom: 'Custom',
	label_orient_p: 'Portrait',
	label_orient_s: 'Square',
	label_orient_l: 'Landscape',
	label_tens_t3: 'Extra Tall',
	label_tens_t2: 'Very Tall',
	label_tens_t1: 'Tall',
	label_tens_t0: 'Equal Tall',
	label_tens_e0: 'Equal',
	label_tens_w0: 'Equal Wide',
	label_tens_w1: 'Wide',
	label_tens_w2: 'Very Wide',
	label_tens_w3: 'Extra Wide',
	label_scale_xs: 'Micro',
	label_scale_s: 'Small',
	label_scale_m: 'Medium',
	label_scale_l: 'Large',
	label_scale_xl: 'Huge',
	label_snapshot: 'Snapshot',
	label_huge: 'Huge',
	label_large: 'Large',
	label_medium: 'Medium',
	label_normal: 'Normal',
	label_small: 'Small',
	label_tiny: 'Tiny',
	label_low: 'Low',
	label_high: 'High',
	label_other: 'Other',
	action_remove_variations_1: 'Remove',
	action_remove_variations_2: 'all active variations.',
	action_remove_source_1: 'Remove',
	action_remove_source_2: 'source.',
	action_clone_source_1: 'Clone',
	action_clone_source_2: 'source from default variation.',
	action_clone_source_3: 'source from previous frame.',
	action_clone_element_1: 'Clone',
	action_clone_element_2: 'element from default variation.',
	action_clone_element_3: 'element from previous frame.',
	action_show_1: 'Show',
	action_set_value_1: 'Set',
	action_set_value_2: 'value to default.'
}"></data>